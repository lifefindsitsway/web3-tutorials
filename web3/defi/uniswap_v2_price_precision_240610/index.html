<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<link href="https://lifefindsitsway.wiki/web3/defi/uniswap_v2_price_precision_240610/" rel="canonical"/>
<link href="../../dapp/ethereum_address_size_240320/" rel="prev"/>
<link href="../flash_loan_attack_260101/" rel="next"/>
<link href="../../../assets/images/favicon.png" rel="icon"/>
<meta content="mkdocs-1.6.1, mkdocs-material-9.5.34" name="generator"/>
<title>Uniswap V2 价格精度解析 - Life's Web3 开发指南</title>
<link href="../../../assets/stylesheets/main.35f28582.min.css" rel="stylesheet"/>
<link href="../../../assets/stylesheets/palette.06af60db.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto+Slab:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto Slab";--md-code-font:"Roboto Mono"}</style>
<link href="../../../css/heti.css" rel="stylesheet"/>
<link href="../../../assets/stylesheets/mathjax-custom.css" rel="stylesheet"/>
<script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-KJB4RXSKZG"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-KJB4RXSKZG",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-KJB4RXSKZG",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
<script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
</head>
<body data-md-color-accent="deep-purple" data-md-color-primary="light-blue" data-md-color-scheme="default" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#uq112112">
          跳转至
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header md-header--shadow" data-md-component="header">
<nav aria-label="页眉" class="md-header__inner md-grid">
<a aria-label="Life's Web3 开发指南" class="md-header__button md-logo" data-md-component="logo" href="../../.." title="Life's Web3 开发指南">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            Life's Web3 开发指南
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Uniswap V2 价格精度解析
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="deep-purple" data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary="light-blue" data-md-color-scheme="default" id="__palette_0" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to dark mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"></path></svg>
</label>
<input aria-label="Switch to light mode" class="md-option" data-md-color-accent="deep-purple" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="black" data-md-color-scheme="slate" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_0" hidden="" title="Switch to light mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"></path></svg>
</label>
</form>
<script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="搜索" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="搜索" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
</label>
<nav aria-label="查找" class="md-search__options">
<a aria-label="分享" class="md-search__icon md-icon" data-clipboard="" data-clipboard-text="" data-md-component="search-share" href="javascript:void(0)" tabindex="-1" title="分享">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"></path></svg>
</a>
<button aria-label="清空当前内容" class="md-search__icon md-icon" tabindex="-1" title="清空当前内容" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
</button>
</nav>
<div class="md-search__suggest" data-md-component="search-suggest"></div>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="" tabindex="0">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/lifefindsitsway/web3-tutorials" title="前往仓库">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg>
</div>
<div class="md-source__repository">
    web3-tutorials
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="导航栏" class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="Life's Web3 开发指南" class="md-nav__button md-logo" data-md-component="logo" href="../../.." title="Life's Web3 开发指南">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg>
</a>
    Life's Web3 开发指南
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/lifefindsitsway/web3-tutorials" title="前往仓库">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg>
</div>
<div class="md-source__repository">
    web3-tutorials
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../..">
<span class="md-ellipsis">
    Welcome to My Blog
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../changelog/">
<span class="md-ellipsis">
    更新日志
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
<span class="md-ellipsis">
    区块链基础
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_3">
<span class="md-nav__icon md-icon"></span>
            区块链基础
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../blockchain/the_evolution_of_bitcoin_240213/">
<span class="md-ellipsis">
    比特币的诞生历程
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
<span class="md-ellipsis">
    DAPP开发
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_4">
<span class="md-nav__icon md-icon"></span>
            DAPP开发
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../dapp/solidity_proxy_upgrade_series_part1_251229/">
<span class="md-ellipsis">
    代理合约与可升级合约系列（一）：为什么需要可升级？
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../dapp/solidity_proxy_upgrade_series_part2_251230/">
<span class="md-ellipsis">
    代理合约与可升级合约系列（二）：透明代理 vs UUPS
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../dapp/gas_optimization_guide_part1_gas_mechanism/">
<span class="md-ellipsis">
    Gas 优化指南（一）：Gas 机制原理
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../dapp/gas_optimization_guide_part2_eip1559_transaction_analysis/">
<span class="md-ellipsis">
    Gas 优化指南（二）：EIP-1559 交易解析
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../dapp/gas_optimization_guide_part3_storage_optimization/">
<span class="md-ellipsis">
    Gas 优化指南（三）：存储优化
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../dapp/gas_optimization_guide_part4_computation_optimization/">
<span class="md-ellipsis">
    Gas 优化指南（四）：计算优化
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../dapp/gas_optimization_guide_part5_gas_measurement/">
<span class="md-ellipsis">
    Gas 优化指南（五）：Gas 评估与测量
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../dapp/solidity_contract_call_part1_240521/">
<span class="md-ellipsis">
    Solidity 合约间调用（一）：四种方式调用已部署合约
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../dapp/solidity_contract_call_part2_240523/">
<span class="md-ellipsis">
    Solidity 合约间调用（二）：底层调用与 calldata 详解
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../dapp/solidity_contract_call_part3_240527/">
<span class="md-ellipsis">
    Solidity 合约间调用（三）：创建合约的两种方式：create 与 create2
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../dapp/hardhat_tutorial_240415/">
<span class="md-ellipsis">
    Hardhat 入门指南（25年更新版）
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../dapp/evm_fundamentals_part1_from_transactions_to_bytecode_240410/">
<span class="md-ellipsis">
    EVM 基础原理（一）：从交易到字节码
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../dapp/evm_fundamentals_part2_data_regions_and_contract_execution_240411/">
<span class="md-ellipsis">
    EVM 基础原理（二）：数据区域与合约执行
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../dapp/evm_fundamentals_part3_abi_encoding_and_low-level_calls_240413/">
<span class="md-ellipsis">
    EVM 基础原理（三）：ABI 编码与底层调用
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../dapp/address_240321/">
<span class="md-ellipsis">
    Solidity 地址类型 &amp; 常见用法全攻略
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../dapp/ethereum_address_size_240320/">
<span class="md-ellipsis">
    为什么以太坊地址是 20 字节？从私钥到地址的全解析
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
<span class="md-ellipsis">
    DeFi
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_5_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_5">
<span class="md-nav__icon md-icon"></span>
            DeFi
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
<span class="md-ellipsis">
    Uniswap V2 价格精度解析
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
<span class="md-ellipsis">
    Uniswap V2 价格精度解析
  </span>
</a>
<nav aria-label="目录" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      目录
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#uq112112">
<span class="md-ellipsis">
      一、UQ112.112 是什么？
    </span>
</a>
<nav aria-label="一、UQ112.112 是什么？" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#11-q">
<span class="md-ellipsis">
      1.1 Q格式的通用定义
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#12">
<span class="md-ellipsis">
      1.2 为什么需要定点数格式？
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#13-0-2112-1">
<span class="md-ellipsis">
      1.3 范围为什么是 [0, 2¹¹² − 1]？
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#112112">
<span class="md-ellipsis">
      二、 为什么是 112+112？存储槽的精妙设计
    </span>
</a>
<nav aria-label="二、 为什么是 112+112？存储槽的精妙设计" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#21-uniswap-v2">
<span class="md-ellipsis">
      2.1 Uniswap V2的存储布局
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#22-32">
<span class="md-ellipsis">
      2.2 累积价格布局：为什么需要额外的32位？
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#32">
<span class="md-ellipsis">
      三、时间戳的32位限制与溢出安全
    </span>
</a>
<nav aria-label="三、时间戳的32位限制与溢出安全" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#31-mod-232">
<span class="md-ellipsis">
      3.1 为什么时间戳要 mod 2³²？
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#32_1">
<span class="md-ellipsis">
      3.2 为什么说“溢出安全”？
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../flash_loan_attack_260101/">
<span class="md-ellipsis">
    闪电贷：从原理到攻击演示
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="目录" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      目录
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#uq112112">
<span class="md-ellipsis">
      一、UQ112.112 是什么？
    </span>
</a>
<nav aria-label="一、UQ112.112 是什么？" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#11-q">
<span class="md-ellipsis">
      1.1 Q格式的通用定义
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#12">
<span class="md-ellipsis">
      1.2 为什么需要定点数格式？
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#13-0-2112-1">
<span class="md-ellipsis">
      1.3 范围为什么是 [0, 2¹¹² − 1]？
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#112112">
<span class="md-ellipsis">
      二、 为什么是 112+112？存储槽的精妙设计
    </span>
</a>
<nav aria-label="二、 为什么是 112+112？存储槽的精妙设计" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#21-uniswap-v2">
<span class="md-ellipsis">
      2.1 Uniswap V2的存储布局
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#22-32">
<span class="md-ellipsis">
      2.2 累积价格布局：为什么需要额外的32位？
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#32">
<span class="md-ellipsis">
      三、时间戳的32位限制与溢出安全
    </span>
</a>
<nav aria-label="三、时间戳的32位限制与溢出安全" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#31-mod-232">
<span class="md-ellipsis">
      3.1 为什么时间戳要 mod 2³²？
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#32_1">
<span class="md-ellipsis">
      3.2 为什么说“溢出安全”？
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1><span>Uniswap V2<span class="heti-spacing"> </span></span>价格精度解析</h1>
<div style="margin-top: -30px; font-size: 0.75em; opacity: 0.7;">
<p><span class="twemoji"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 2A10 10 0 0 0 2 12a10 10 0 0 0 10 10 10 10 0 0 0 10-10h-2a8 8 0 0 1-8 8 8 8 0 0 1-8-8 8 8 0 0 1 8-8zm6.78 1a.7.7 0 0 0-.48.2l-1.22 1.21 2.5 2.5L20.8 5.7c.26-.26.26-.7 0-.95L19.25 3.2c-.13-.13-.3-.2-.47-.2m-2.41 2.12L9 12.5V15h2.5l7.37-7.38z"></path></svg></span> 约<span class="heti-skip"><span class="heti-spacing"> </span>2543<span class="heti-spacing"> </span></span>个字 <span class="twemoji"><svg viewbox="0 0 640 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M392.8 1.2c-17-4.9-34.7 5-39.6 22l-128 448c-4.9 17 5 34.7 22 39.6s34.7-5 39.6-22l128-448c4.9-17-5-34.7-22-39.6m80.6 120.1c-12.5 12.5-12.5 32.8 0 45.3l89.3 89.4-89.4 89.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l112-112c12.5-12.5 12.5-32.8 0-45.3l-112-112c-12.5-12.5-32.8-12.5-45.3 0zm-306.7 0c-12.5-12.5-32.8-12.5-45.3 0l-112 112c-12.5 12.5-12.5 32.8 0 45.3l112 112c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256l89.4-89.4c12.5-12.5 12.5-32.8 0-45.3"></path></svg></span> <span>25<span class="heti-spacing"> </span></span>行代码 <span class="twemoji"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 20c4.42 0 8-3.58 8-8s-3.58-8-8-8-8 3.58-8 8 3.58 8 8 8m0-18c5.5 0 10 4.5 10 10s-4.5 10-10 10C6.47 22 2 17.5 2 12S6.5 2 12 2m.5 11H11V7h1.5v4.26l3.7-2.13.75 1.3z"></path></svg></span> 预计阅读时间<span class="heti-skip"><span class="heti-spacing"> </span>9<span class="heti-spacing"> </span></span>分钟</p>
</div>
<p>从<span class="heti-skip"><span class="heti-spacing"> </span>DeFi<span class="heti-spacing"> </span></span>开发者的角度，深入解析<span class="heti-skip"><span class="heti-spacing"> </span>Uniswap V2<span class="heti-spacing"> </span></span>白皮书中关于价格精度的内容。这是<span class="heti-skip"><span class="heti-spacing"> </span>Uniswap V2<span class="heti-spacing"> </span></span>工程设计的精华之一，体现了在<span class="heti-skip"><span class="heti-spacing"> </span>EVM<span class="heti-spacing"> </span></span>约束下的极致优化思维。</p>
<p><span>Uniswap V2<span class="heti-spacing"> </span></span>白皮书<span class="heti-skip"><span class="heti-spacing"> </span>2.2.1<span class="heti-spacing"> </span></span>这章节主要在回答三个问题：</p>
<ol>
<li>链上怎么表示“价格”这种小数？</li>
<li>为什么是<span><span class="heti-spacing"> </span>112+112</span>，跟<span class="heti-skip"><span class="heti-spacing"> </span>224 / 256<span class="heti-spacing"> </span></span>位、gas、存储布局有什么关系？</li>
<li>为什么要把时间戳压成<span class="heti-skip"><span class="heti-spacing"> </span>32<span class="heti-spacing"> </span></span>位、溢出之后怎么还能正确算<span><span class="heti-spacing"> </span>TWAP</span>？</li>
</ol>
<h2 id="uq112112">一、<span>UQ112.112<span class="heti-spacing"> </span></span>是什么？<a class="headerlink" href="#uq112112" title="Permanent link">¶</a></h2>
<h3 id="11-q"><span>1.1 Q<span class="heti-spacing"> </span></span>格式的通用定义<a class="headerlink" href="#11-q" title="Permanent link"><span><span class="heti-spacing"> </span>¶</span></a></h3>
<p><code>Qm.n</code> 是一种表示定点数的格式，<strong>“Q” 代表“二进制小数点位置”（binary point position）</strong>。它是一种<strong>命名惯例</strong>，用于明确指示在一个整数中，哪里是整数部分和小数部分的分界线。其中：</p>
<ul>
<li>m：代表整数部分（在小数点左边）占用的位数；</li>
<li>n：代表小数部分（在小数点右边）占用的位数；</li>
<li>总数：<code>m + n</code> 位，通常对应一个标准整数类型（如<span class="heti-skip"><span class="heti-spacing"> </span>int32, uint16<span class="heti-spacing"> </span></span>等<heti-adjacent class="heti-adjacent-half">）</heti-adjacent>。</li>
</ul>
<h3 id="12"><span>1.2<span class="heti-spacing"> </span></span>为什么需要定点数格式？<a class="headerlink" href="#12" title="Permanent link">¶</a></h3>
<p>Solidity（以及<span><span class="heti-spacing"> </span>EVM</span>）原生只支持整数运算，没有浮点数类型，但价格天然是小数，例如：1 ETH = 3049.5 USDC。</p>
<p><strong>传统方案的问题：</strong>如果直接用 <code>reserve_a / reserve_b</code> 计算价格，<span>Solidity<span class="heti-spacing"> </span></span>会做整数除法，丢失所有小数部分，比如 <code>1 / 2000 = 0</code>（整数除法<heti-adjacent class="heti-adjacent-half">）</heti-adjacent>。</p>
<p><strong><span>Uniswap V2<span class="heti-spacing"> </span></span>的解决方案：</strong>使用定点数（Fixed Point）格式 <code>UQ112.112</code>。 <code>UQ112.112</code> 是<code>Qm.n</code> 格式的一个变体：</p>
<ul>
<li>U：代表<span><span class="heti-spacing"> </span>Unsigned</span>（无符号<heti-adjacent class="heti-adjacent-half">）</heti-adjacent>，这个数永远是正的，因为价格不可能为负；</li>
<li>
<p>Q112.112：表示这是一个定点数，其中：</p>
</li>
<li>
<ul>
<li>小数点左边有<span class="heti-skip"><span class="heti-spacing"> </span>112<span class="heti-spacing"> </span></span>位（用于表示整数部分<heti-adjacent class="heti-adjacent-half">）</heti-adjacent>；</li>
</ul>
</li>
<li>小数点右边有<span class="heti-skip"><span class="heti-spacing"> </span>112<span class="heti-spacing"> </span></span>位（用于表示小数部分<heti-adjacent class="heti-adjacent-half">）</heti-adjacent>；</li>
<li>总计<span class="heti-skip"><span class="heti-spacing"> </span>224<span class="heti-spacing"> </span></span>位<span><span class="heti-spacing"> </span>(</span><code>112 + 112</code><span><span class="heti-spacing"> </span>)</span>。</li>
</ul>
<p><span>Uniswap V2<span class="heti-spacing"> </span></span>白皮书原文：</p>
<blockquote>
<p>prices at a given moment are stored as UQ112.112 numbers, meaning that 112 fractional bits of precision are specified on either side of the decimal point, with no sign. These numbers have a range of [0, 2¹¹² − 1] and a precision of 1 / 2¹¹². </p>
</blockquote>
<p>翻译一下，就是<heti-adjacent class="heti-adjacent-quarter">：</heti-adjacent>“我们没有浮点数，只好自己造一个二进制定点小数格式：把一个数拆成两部分：</p>
<ul>
<li>前<span class="heti-skip"><span class="heti-spacing"> </span>112<span class="heti-spacing"> </span></span>位：整数部分（0 ~ 2¹¹² − 1）</li>
<li>后<span class="heti-skip"><span class="heti-spacing"> </span>112<span class="heti-spacing"> </span></span>位：小数部分（精度<span><span class="heti-spacing"> </span>2</span>⁻¹¹²）</li>
<li>不带符号（unsigned<heti-adjacent class="heti-adjacent-half">）</heti-adjacent>，只表示非负<heti-adjacent class="heti-adjacent-quarter">。</heti-adjacent>”</li>
</ul>
<h3 id="13-0-2112-1"><span>1.3<span class="heti-spacing"> </span></span>范围为什么是<span><span class="heti-spacing"> </span>[0, 2¹¹²</span> − 1]？<a class="headerlink" href="#13-0-2112-1" title="Permanent link">¶</a></h3>
<p>这里指的是价格的整数部分的范围，不是整个<span class="heti-skip"><span class="heti-spacing"> </span>224<span class="heti-spacing"> </span></span>位数值整体的范围。</p>
<p>白皮书脚注解释得很清楚：<span>Uniswap<span class="heti-spacing"> </span></span>里这个<span class="heti-skip"><span class="heti-spacing"> </span>UQ112.112<span class="heti-spacing"> </span></span>的价格<strong>永远来自两个<span class="heti-skip"><span class="heti-spacing"> </span>uint112<span class="heti-spacing"> </span></span>储备的比值</strong>：</p>
<blockquote>
<p>UQ112.112 numbers in Uniswap are always generated from the ratio of two uint112s. The largest such ratio is (2¹¹²−1) / 1 = 2¹¹² − 1.</p>
</blockquote>
<p>在<span class="heti-skip"><span class="heti-spacing"> </span>UniswapV2Pair.sol<span class="heti-spacing"> </span></span>合约中，<code>reserve0</code>、<code>reserve1</code> 被定义为 <code>uint112</code> 类型，最大价格情况是：一边储备接近 <code>2¹¹²−1</code>，另一边接近<span><span class="heti-spacing"> </span>1</span>，所以价格最大 ≈ <code>(2¹¹²−1) / 1 ≈ 2¹¹²−1</code>。</p>
<p>补充：储备金 <code>reserve0</code>、<code>reserve1</code> 是整数计数（<code>uint112</code><heti-adjacent class="heti-adjacent-half">）</heti-adjacent>，没有小数位，表示池子里真实存在的<span class="heti-skip"><span class="heti-spacing"> </span>Token<span class="heti-spacing"> </span></span>数量，是不可再细分的最小单位（wei、最小<span class="heti-skip"><span class="heti-spacing"> </span>ERC20<span class="heti-spacing"> </span></span>单位<heti-adjacent class="heti-adjacent-half">）</heti-adjacent>，理论上储备最小能到<span><span class="heti-spacing"> </span>1</span>，最大为 <code>2¹¹²−1</code>。</p>
<p>这保证了整数部分最多需要<span class="heti-skip"><span class="heti-spacing"> </span>112<span class="heti-spacing"> </span></span>位就够了（0 ~ 2¹¹²−1<heti-adjacent class="heti-adjacent-half">）</heti-adjacent>，小数部分再给<span class="heti-skip"><span class="heti-spacing"> </span>112<span class="heti-spacing"> </span></span>位，整体<span class="heti-skip"><span class="heti-spacing"> </span>224<span class="heti-spacing"> </span></span>位，刚好放进 <code>uint224</code>。</p>
<table>
<thead>
<tr>
<th>概念</th>
<th>值范围</th>
<th>数据类型</th>
<th>用途</th>
</tr>
</thead>
<tbody>
<tr>
<td>reserve0, reserve1</td>
<td>0 ~ 2¹¹²−1</td>
<td>uint112</td>
<td>储备数量（整数）</td>
</tr>
<tr>
<td>price = reserve1/reserve0</td>
<td>0 ~ 2¹¹²−1.xxx</td>
<td>UQ112.112</td>
<td>价格（小数<span class="heti-skip"><span class="heti-spacing"> </span>+<span class="heti-spacing"> </span></span>高精度）</td>
</tr>
<tr>
<td><span>UQ112.112<span class="heti-spacing"> </span></span>小数位</td>
<td>2⁻¹¹²</td>
<td>底层位移</td>
<td>表示价格的小数部分</td>
</tr>
</tbody>
</table>
<p>精度上，一个<span class="heti-skip"><span class="heti-spacing"> </span>UQ112.112<span class="heti-spacing"> </span></span>的最小单位是 <code>1 / 2¹¹²</code>，大约<span><span class="heti-spacing"> </span>10</span>⁻³⁴ 量级，远远比<span class="heti-skip"><span class="heti-spacing"> </span>1e-18<span class="heti-spacing"> </span></span>还细，对于现实中<span><span class="heti-spacing"> </span>token 18 decimals</span>、价格几位小数的应用，这个精度完全够用且浪费一点没关系，重点是方便数学和存储布局。</p>
<h2 id="112112">二、 为什么是<span><span class="heti-spacing"> </span>112+112</span>？存储槽的精妙设计<a class="headerlink" href="#112112" title="Permanent link"><span><span class="heti-spacing"> </span>¶</span></a></h2>
<p>这是整个设计最巧妙的地方，涉及到<strong><span>Gas<span class="heti-spacing"> </span></span>优化</strong>和<strong>存储布局</strong>。</p>
<p><strong><span>EVM<span class="heti-spacing"> </span></span>存储槽基础：</strong><span>EVM<span class="heti-spacing"> </span></span>的一个存储槽（storage slot）<span>= 256<span class="heti-spacing"> </span></span>位，每次 <code>SSTORE</code> 操作（写入存储）消耗大量<span><span class="heti-spacing"> </span>Gas</span>（~20,000 gas<heti-adjacent class="heti-adjacent-half">）</heti-adjacent>，打包存储（packing）可以在一个槽内存多个变量，节省<span><span class="heti-spacing"> </span>Gas</span>。</p>
<p>白皮书关键句：</p>
<blockquote>
<p>The UQ112.112 format was chosen for a pragmatic reason — because these numbers can be stored in a uint224, this leaves 32 bits of a 256 bit storage slot free.
It also happens that the reserves, each stored in a uint112, also leave 32 bits free in a (packed) 256 bit storage slot.</p>
</blockquote>
<p>从以太坊合约存储视角来看就是：</p>
<ul>
<li>储备金存储：每个储备金（<code>uint112</code>）用了<span class="heti-skip"><span class="heti-spacing"> </span>112<span class="heti-spacing"> </span></span>位，两个 <code>uint112</code> 可以紧密打包在一个<span class="heti-skip"><span class="heti-spacing"> </span>256<span class="heti-spacing"> </span></span>位的存储槽里，留下 <code>256 - 2*112 = 32</code> 位空闲。</li>
<li>价格存储：价格作为两个 <code>uint112</code> 储备金的比率，自然可以表示为一个 <code>UQ112.112</code> 数，它刚好能装进一个 <code>uint224</code>（<span>224<span class="heti-spacing"> </span></span>位<heti-adjacent class="heti-adjacent-half">）</heti-adjacent>。</li>
<li>
<p>空闲位的利用：核心来了！那个空闲的<span class="heti-skip"><span class="heti-spacing"> </span>32<span class="heti-spacing"> </span></span>位（来自储备金存储槽）和价格存储槽末尾的<span class="heti-skip"><span class="heti-spacing"> </span>32<span class="heti-spacing"> </span></span>位，被巧妙地用来：</p>
</li>
<li>
<ul>
<li>存储<strong>时间戳</strong>（模 <code>2^32</code>，刚好<span class="heti-skip"><span class="heti-spacing"> </span>32<span class="heti-spacing"> </span></span>位<heti-adjacent class="heti-adjacent-half">）</heti-adjacent>；</li>
</ul>
</li>
<li>存储价格累加过程中的<strong>溢出位</strong>（因为连续累加可能超过<span class="heti-skip"><span class="heti-spacing"> </span>224<span class="heti-spacing"> </span></span>位<heti-adjacent class="heti-adjacent-half">）</heti-adjacent>。</li>
</ul>
<p>在<strong>不支持浮点数</strong>的<span class="heti-skip"><span class="heti-spacing"> </span>EVM<span class="heti-spacing"> </span></span>中，<strong>用整数运算来模拟高精度的小数运算</strong>，同时完美契合存储布局，将预言机更新的<span class="heti-skip"><span class="heti-spacing"> </span>Gas<span class="heti-spacing"> </span></span>成本降至最低（仅首次交易增加约<span><span class="heti-spacing"> </span>15,000 gas</span><heti-adjacent class="heti-adjacent-half">）</heti-adjacent>。</p>
<h3 id="21-uniswap-v2"><span>2.1 Uniswap V2<span class="heti-spacing"> </span></span>的存储布局<a class="headerlink" href="#21-uniswap-v2" title="Permanent link"><span><span class="heti-spacing"> </span>¶</span></a></h3>
<p>实际代码结构（简化版<heti-adjacent class="heti-adjacent-half">）</heti-adjacent>：</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-0-1" id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="k">contract</span><span class="w"> </span><span class="ni">UniswapV2Pair</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-0-2" id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="w">    </span><span class="kt">uint112</span><span class="w"> </span><span class="k">private </span><span class="nv">reserve0</span><span class="p">;</span><span class="w">           </span><span class="c1">// 112位</span>
<a href="#__codelineno-0-3" id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="w">    </span><span class="kt">uint112</span><span class="w"> </span><span class="k">private </span><span class="nv">reserve1</span><span class="p">;</span><span class="w">           </span><span class="c1">// 112位  </span>
<a href="#__codelineno-0-4" id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="w">    </span><span class="kt">uint32</span><span class="w">  </span><span class="k">private </span><span class="nv">blockTimestampLast</span><span class="p">;</span><span class="w"> </span><span class="c1">// 32位</span>
<a href="#__codelineno-0-5" id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="w">    </span><span class="c1">// 总共: 112 + 112 + 32 = 256位 = 1个存储槽！</span>
<a href="#__codelineno-0-6" id="__codelineno-0-6" name="__codelineno-0-6"></a>
<a href="#__codelineno-0-7" id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="w">    </span><span class="kt">uint224</span><span class="w"> </span><span class="k">public </span><span class="nv">price0CumulativeLast</span><span class="p">;</span><span class="w"> </span><span class="c1">// 224位</span>
<a href="#__codelineno-0-8" id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="w">    </span><span class="kt">uint32</span><span class="w">  </span><span class="k">private </span><span class="nv">overflowBits0</span><span class="p">;</span><span class="w">       </span><span class="c1">// 32位（溢出部分）</span>
<a href="#__codelineno-0-9" id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="w">    </span><span class="c1">// 总共: 224 + 32 = 256位 = 1个存储槽！</span>
<a href="#__codelineno-0-10" id="__codelineno-0-10" name="__codelineno-0-10"></a>
<a href="#__codelineno-0-11" id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="w">    </span><span class="kt">uint224</span><span class="w"> </span><span class="k">public </span><span class="nv">price1CumulativeLast</span><span class="p">;</span><span class="w"> </span><span class="c1">// 224位</span>
<a href="#__codelineno-0-12" id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="w">    </span><span class="kt">uint32</span><span class="w">  </span><span class="k">private </span><span class="nv">overflowBits1</span><span class="p">;</span><span class="w">       </span><span class="c1">// 32位（溢出部分）</span>
<a href="#__codelineno-0-13" id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="w">    </span><span class="c1">// 总共: 224 + 32 = 256位 = 1个存储槽！</span>
<a href="#__codelineno-0-14" id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="p">}</span>
</code></pre></div>
<p><span>Solidity<span class="heti-spacing"> </span></span>的<span class="heti-skip"><span class="heti-spacing"> </span>storage packing<span class="heti-spacing"> </span></span>规则：在同一个 <code>slot(256bit)</code> 里尽量塞满紧挨着的小类型：</p>
<ul>
<li>112 + 112 + 32 = 256</li>
<li>刚好塞满一个<span class="heti-skip"><span class="heti-spacing"> </span>256<span class="heti-spacing"> </span></span>位槽，不浪费、不多用<span><span class="heti-spacing"> </span>gas</span>。</li>
</ul>
<p>这就是“packed 256 bit storage slot”的含义：<strong>两个储备<span class="heti-skip"><span class="heti-spacing"> </span>+ 1<span class="heti-spacing"> </span></span>个<span class="heti-skip"><span class="heti-spacing"> </span>32bit<span class="heti-spacing"> </span></span>时间戳</strong>，整整齐齐放在一个槽里。</p>
<h3 id="22-32"><span>2.2<span class="heti-spacing"> </span></span>累积价格布局：为什么需要额外的<span class="heti-skip"><span class="heti-spacing"> </span>32<span class="heti-spacing"> </span></span>位？<a class="headerlink" href="#22-32" title="Permanent link">¶</a></h3>
<p>白皮书接着说：</p>
<blockquote>
<p>although the price at any given moment (stored as a UQ112.112 number) is guaranteed to fit in 224 bits, the accumulation of this price over an interval is not. The extra 32 bits on the end of the storage slots for the accumulated price of A/B and B/A are used to store overflow bits resulting from repeated summations of prices.</p>
</blockquote>
<p>白皮书说：<span>"<span class="heti-spacing"> </span></span>虽然任何给定时刻的价格保证适合<span class="heti-skip"><span class="heti-spacing"> </span>224<span class="heti-spacing"> </span></span>位，但该价格在一个区间内的累积则不然。"</p>
<ul>
<li>瞬时价格：UQ112.112，用 <code>uint224</code> 就够存；</li>
<li>累积价格：<code>priceCumulativeLast += price * timeElapsed</code>，<code>price</code> 是<span><span class="heti-spacing"> </span>UQ112.112</span>（<span>224<span class="heti-spacing"> </span></span>位<heti-adjacent class="heti-adjacent-half">）</heti-adjacent>，<code>timeElapsed</code> 是 <code>uint32</code> 秒数，每次乘法结果可能需要<span class="heti-skip"><span class="heti-spacing"> </span>224 + 32 = 256<span class="heti-spacing"> </span></span>位，再不断累加，肯定会“理论上溢出<span class="heti-skip"><span class="heti-spacing"> </span>224<span class="heti-spacing"> </span></span>位”。</li>
</ul>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-1-1" id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="kt">if</span><span class="w"> </span><span class="p">(</span>timeElapsed<span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m m-Decimal">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>_reserve0<span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="m m-Decimal">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>_reserve1<span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="m m-Decimal">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-1-2" id="__codelineno-1-2" name="__codelineno-1-2"></a><span class="w">    </span>price0CumulativeLast<span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="kt">uint</span><span class="p">(</span>
<a href="#__codelineno-1-3" id="__codelineno-1-3" name="__codelineno-1-3"></a><span class="w">        </span>UQ112x112<span class="p">.</span>encode<span class="p">(</span>_reserve1<span class="p">).</span>uqdiv<span class="p">(</span>_reserve0<span class="p">)</span>
<a href="#__codelineno-1-4" id="__codelineno-1-4" name="__codelineno-1-4"></a><span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span>timeElapsed<span class="p">;</span>
<a href="#__codelineno-1-5" id="__codelineno-1-5" name="__codelineno-1-5"></a><span class="w">    </span>price1CumulativeLast<span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="kt">uint</span><span class="p">(</span>
<a href="#__codelineno-1-6" id="__codelineno-1-6" name="__codelineno-1-6"></a><span class="w">        </span>UQ112x112<span class="p">.</span>encode<span class="p">(</span>_reserve0<span class="p">).</span>uqdiv<span class="p">(</span>_reserve1<span class="p">)</span>
<a href="#__codelineno-1-7" id="__codelineno-1-7" name="__codelineno-1-7"></a><span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span>timeElapsed<span class="p">;</span>
<a href="#__codelineno-1-8" id="__codelineno-1-8" name="__codelineno-1-8"></a><span class="p">}</span>
</code></pre></div>
<p>注意几点：</p>
<ul>
<li><code>UQ112x112.encode(...).uqdiv(...)</code> 返回的是一个 <code>uint224</code> 的<span class="heti-skip"><span class="heti-spacing"> </span>UQ112.112<span class="heti-spacing"> </span></span>数。</li>
<li><code>uint(...)</code> 转成 <code>uint256</code>，再乘 <code>timeElapsed (uint32)</code>，整体用<span class="heti-skip"><span class="heti-spacing"> </span>256<span class="heti-spacing"> </span></span>位做算术。</li>
<li>溢出行为是按 <code>mod 2²⁵⁶</code> 来的（<span>Solidity 0.5/0.6<span class="heti-spacing"> </span></span>下，默认<span><span class="heti-spacing"> </span>wrap around</span><heti-adjacent class="heti-adjacent-half">）</heti-adjacent>。</li>
</ul>
<p>直觉理解<heti-adjacent class="heti-adjacent-quarter">：</heti-adjacent>“我用<span class="heti-skip"><span class="heti-spacing"> </span>224<span class="heti-spacing"> </span></span>位存价格小数，额外开了<span class="heti-skip"><span class="heti-spacing"> </span>32<span class="heti-spacing"> </span></span>位当缓冲区，给长期累加留空间。真正拿来算<span class="heti-skip"><span class="heti-spacing"> </span>TWAP<span class="heti-spacing"> </span></span>是用差值除以时间间隔，所以只要下游用同样的 ‘取模<span class="heti-skip"><span class="heti-spacing"> </span>+<span class="heti-spacing"> </span></span>溢出安全算术’，就能正确恢复平均值<heti-adjacent class="heti-adjacent-quarter">。</heti-adjacent>”</p>
<h2 id="32">三、时间戳的<span class="heti-skip"><span class="heti-spacing"> </span>32<span class="heti-spacing"> </span></span>位限制与溢出安全<a class="headerlink" href="#32" title="Permanent link"><span><span class="heti-spacing"> </span>¶</span></a></h2>
<p>白皮书这段话是容易疑惑的地方：</p>
<blockquote>
<p>The primary downside is that 32 bits isn't quite enough to store timestamp values that will reasonably never overflow. In fact, the date when the Unix timestamp overflows a uint32 is 02/07/2106. To ensure that this system continues to function properly after this date, and every multiple of 2³² - 1 seconds thereafter, oracles are simply required to check prices at least once per interval (approximately 136 years). This is because the core method of accumulation (and modding of timestamp), is actually overflow-safe, meaning that trades across overflow intervals can be appropriately accounted for given that oracles are using the proper (simple) overflow arithmetic to compute deltas.</p>
</blockquote>
<p>翻译成中文来理解：</p>
<p><span>32<span class="heti-spacing"> </span></span>位的主要缺点在于：它不足以存储“永远不会溢出”的时间戳值。事实上，<span>Unix<span class="heti-spacing"> </span></span>时间戳在 <code>uint32</code> 中溢出的日期是<span class="heti-skip"><span class="heti-spacing"> </span>2106<span class="heti-spacing"> </span></span>年<span class="heti-skip"><span class="heti-spacing"> </span>2<span class="heti-spacing"> </span></span>月<span class="heti-skip"><span class="heti-spacing"> </span>7<span class="heti-spacing"> </span></span>日。为了确保这个系统在该日期之后仍能正常运行，并在之后每经过 <code>2³² - 1</code> 秒（大约<span class="heti-skip"><span class="heti-spacing"> </span>136<span class="heti-spacing"> </span></span>年）再次溢出时继续正常工作，预言机（oracles）只需要做到一件事：在每个周期里至少检查一次价格（也就是大约每<span class="heti-skip"><span class="heti-spacing"> </span>136<span class="heti-spacing"> </span></span>年检查一次<heti-adjacent class="heti-adjacent-half">）</heti-adjacent>。</p>
<p>这是因为累积（accumulation）以及对时间戳进行取模（modding of timestamp）的核心方法本身是溢出安全的。只要预言机在计算时间差（delta）时使用正确的（简单的）溢出算术，即使交易跨越了时间戳溢出的间隔，也仍然能够被正确记账。</p>
<h3 id="31-mod-232"><span>3.1<span class="heti-spacing"> </span></span>为什么时间戳要<span><span class="heti-spacing"> </span>mod 2³²</span>？<a class="headerlink" href="#31-mod-232" title="Permanent link">¶</a></h3>
<p>这跟前面说的“两个<code>uint112</code><span class="heti-skip"><span class="heti-spacing"> </span>+<span class="heti-spacing"> </span></span>一个 <code>uint32</code> 拼在同一槽”是同一个设计：</p>
<p><code>block.timestamp</code> 是一个不断增大的<span class="heti-skip"><span class="heti-spacing"> </span>Unix<span class="heti-spacing"> </span></span>时间戳（秒<heti-adjacent class="heti-adjacent-half">）</heti-adjacent>，为了塞进<span class="heti-skip"><span class="heti-spacing"> </span>32<span class="heti-spacing"> </span></span>位，要做：<code>uint32 blockTimestamp = uint32(block.timestamp % 2**32)</code>，存的时候只保留低<span class="heti-skip"><span class="heti-spacing"> </span>32<span class="heti-spacing"> </span></span>位（对<span class="heti-skip"><span class="heti-spacing"> </span>2³²<span class="heti-spacing"> </span></span>取模<heti-adjacent class="heti-adjacent-half">）</heti-adjacent>。</p>
<p>更新时 <code>_update()</code> 的流程（简化<heti-adjacent class="heti-adjacent-half">）</heti-adjacent>：</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-2-1" id="__codelineno-2-1" name="__codelineno-2-1"></a><span class="kt">uint32</span><span class="w"> </span><span class="nv">blockTimestamp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">uint32</span><span class="p">(</span><span class="k">block.timestamp</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="m m-Decimal">2</span><span class="o">**</span><span class="m m-Decimal">32</span><span class="p">);</span>
<a href="#__codelineno-2-2" id="__codelineno-2-2" name="__codelineno-2-2"></a><span class="kt">uint32</span><span class="w"> </span><span class="nv">timeElapsed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>blockTimestamp<span class="w"> </span><span class="o">-</span><span class="w"> </span>blockTimestampLast<span class="p">;</span><span class="w"> </span><span class="c1">// 注意：这是 uint32 减法</span>
<a href="#__codelineno-2-3" id="__codelineno-2-3" name="__codelineno-2-3"></a><span class="c1">// timeElapsed 就是“自上次更新以来经过的秒数”，但有溢出语义</span>
</code></pre></div>
<p>这一步的关键：<code>uint32</code> 的减法在溢出时自动按<span class="heti-skip"><span class="heti-spacing"> </span>2³²<span class="heti-spacing"> </span></span>取模。</p>
<p>在没溢出的一般情况下：<code>timeElapsed = current - last</code></p>
<p>在经历过一次<span class="heti-skip"><span class="heti-spacing"> </span>2³²<span class="heti-spacing"> </span></span>溢出（时间戳绕了一圈<heti-adjacent class="heti-adjacent-half">）</heti-adjacent>：假设 <code>last = 2³² - 10</code><heti-adjacent class="heti-adjacent-half">，</heti-adjacent><code>current = 5</code>（绕了一圈<span class="heti-skip"><span class="heti-spacing"> </span>+5<span class="heti-spacing"> </span></span>秒<heti-adjacent class="heti-adjacent-half">）</heti-adjacent>，<code>timeElapsed = 5 - (2³² - 10)</code>，在 <code>uint32</code> 下等价于：<code>timeElapsed = 5 + 10 = 15</code>，也就是：实际经过的时间（<span>10<span class="heti-spacing"> </span></span>秒到圈尾<span class="heti-skip"><span class="heti-spacing"> </span>+ 5<span class="heti-spacing"> </span></span>秒到当前<heti-adjacent class="heti-adjacent-half">）</heti-adjacent>。</p>
<p>这就是白皮书所说的“overflow-safe accumulation”：只要<strong>始终用同样的<span class="heti-skip"><span class="heti-spacing"> </span>32<span class="heti-spacing"> </span></span>位取模<span class="heti-skip"><span class="heti-spacing"> </span>+<span class="heti-spacing"> </span></span>溢出语义</strong>，不需要关心时间戳“绕了几圈”，每次<span class="heti-skip"><span class="heti-spacing"> </span>delta<span class="heti-spacing"> </span></span>都是正确的。</p>
<h3 id="32_1"><span>3.2<span class="heti-spacing"> </span></span>为什么说“溢出安全”？<a class="headerlink" href="#32_1" title="Permanent link">¶</a></h3>
<p><span>2³²<span class="heti-spacing"> </span></span>秒 ≈ <span>4,294,967,296<span class="heti-spacing"> </span></span>秒 ≈ <span>136<span class="heti-spacing"> </span></span>年。</p>
<p>核心问题在于：<strong><span>TWAP<span class="heti-spacing"> </span></span>的调用方也要用同样的溢出算术</strong>。</p>
<p>调用方通常这样算价格（来自白皮书<span><span class="heti-spacing"> </span>2.2</span><heti-adjacent class="heti-adjacent-half">）</heti-adjacent>：</p>
<ul>
<li>在<span class="heti-skip"><span class="heti-spacing"> </span>t1<span class="heti-spacing"> </span></span>时刻读取一次<span><span class="heti-spacing"> </span>priceCumulativeLast</span>，记作<span><span class="heti-spacing"> </span>a1</span></li>
<li>在<span class="heti-skip"><span class="heti-spacing"> </span>t2<span class="heti-spacing"> </span></span>时刻再读一次<span><span class="heti-spacing"> </span>a2</span></li>
<li>TWAP ≈ (a2 - a1) / (t2 - t1)</li>
</ul>
<p>如果：</p>
<ul>
<li><span>t1<span class="heti-spacing"> </span></span>和<span class="heti-skip"><span class="heti-spacing"> </span>t2<span class="heti-spacing"> </span></span>之间<strong>跨越了多次<span class="heti-skip"><span class="heti-spacing"> </span>2³²<span class="heti-spacing"> </span></span>溢出周期</strong>（比如隔了<span class="heti-skip"><span class="heti-spacing"> </span>300<span class="heti-spacing"> </span></span>年，绕了两圈多<heti-adjacent class="heti-adjacent-half">）</heti-adjacent>，那么单纯用<span class="heti-skip"><span class="heti-spacing"> </span>32<span class="heti-spacing"> </span></span>位时间戳差值就不够区分了。</li>
<li>但只要<strong>每个<span class="heti-skip"><span class="heti-spacing"> </span>2³²<span class="heti-spacing"> </span></span>秒（约<span class="heti-skip"><span class="heti-spacing"> </span>136<span class="heti-spacing"> </span></span>年）内至少读一次</strong>，你不会跨越超过一圈的模数，<span>t2 - t1<span class="heti-spacing"> </span></span>的<span class="heti-skip"><span class="heti-spacing"> </span>32<span class="heti-spacing"> </span></span>位溢出语义仍能正确代表真实经过的秒数。</li>
</ul>
<p>举个例子：假设</p>
<ul>
<li>t1 =2^32-100（溢出前<span class="heti-skip"><span class="heti-spacing"> </span>100<span class="heti-spacing"> </span></span>秒）</li>
<li>t2 =50（溢出后<span class="heti-skip"><span class="heti-spacing"> </span>50<span class="heti-spacing"> </span></span>秒，实际时间戳）</li>
</ul>
<p>直接相减会出错：<code>50 - (2^32 - 100) = 负数</code>，但使用 <code>uint32</code> 的模运算：</p>
<p>时间差<span class="heti-skip"><span class="heti-spacing"> </span>=<span class="heti-spacing"> </span></span><code>uint32(t2 - t1) = uint32(50-(2^32-100)) = uint32(-2^32+150)</code><span class="heti-skip"><span class="heti-spacing"> </span>= 150<span class="heti-spacing"> </span></span>秒</p>
<p>只要两次采样间隔<span class="heti-skip"><span class="heti-spacing"> </span>&lt; 2^32<span class="heti-spacing"> </span></span>秒（<span>136<span class="heti-spacing"> </span></span>年<heti-adjacent class="heti-adjacent-half">）</heti-adjacent>，计算就是正确的。</p>
<aside class="md-source-file">
<span class="md-source-file__fact">
<span class="md-icon" title="最后更新">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"></path></svg>
</span>
<span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-datetime">2026年1月15日 00:12:51</span>
</span>
</aside>
<!-- Insert generated snippet here -->
<script async="" crossorigin="anonymous" data-category="Comments" data-category-id="DIC_kwDOMt1b5c4CiWjc" data-emit-metadata="1" data-input-position="top" data-lang="zh-CN" data-loading="lazy" data-mapping="title" data-reactions-enabled="1" data-repo="lifefindsitsway/web3-tutorials" data-repo-id="R_kgDOMt1b5Q" data-strict="0" data-theme="light_protanopia" src="https://giscus.app/client.js">
</script>
<!-- Synchronize Giscus theme with palette -->
<script>
var giscus = document.querySelector("script[src*=giscus]")

// Set palette on initial load
var palette = __md_get("__palette")
if (palette && typeof palette.color === "object") {
    var theme = palette.color.scheme === "slate"
    ? "dark_protanopia"
    : "light_protanopia"

    // Instruct Giscus to set theme
    giscus.setAttribute("data-theme", theme) 
}

// Register event handlers after documented loaded
document.addEventListener("DOMContentLoaded", function() {
    var ref = document.querySelector("[data-md-component=palette]")
    ref.addEventListener("change", function() {
    var palette = __md_get("__palette")
    if (palette && typeof palette.color === "object") {
        var theme = palette.color.scheme === "slate"
        ? "dark_protanopia"
        : "light_protanopia"

        // Instruct Giscus to change theme
        var frame = document.querySelector(".giscus-frame")
        frame.contentWindow.postMessage(
        { giscus: { setConfig: { theme } } },
        "https://giscus.app"
        )
    }
    })
})
</script>
</article>
</div>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
<button class="md-top md-icon" data-md-component="top" hidden="" type="button">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg>
  回到页面顶部
</button>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
<div class="md-copyright__highlight">
      Copyright © 2024 ~ present by <a href="https://github.com/lifefindsitsway" rel="noopener noreferrer" target="_blank">Lifefindsitsway</a>
</div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
<div class="md-social">
<a class="md-social__link" href="https://github.com/lifefindsitsway/web3-tutorials/" rel="noopener" target="_blank" title="github.com">
<svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg>
</a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../../..", "features": ["header.autohide", "navigation.tracking", "navigation.top", "search.highlight", "search.share", "search.suggest", "content.code.copy", "content.code.annotate"], "search": "../../../assets/javascripts/workers/search.07f07601.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script>
<script src="../../../assets/javascripts/bundle.56dfad97.min.js"></script>
<script src="../../../assets/javascripts/mathjax-config.js"></script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</body>
</html>