<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<link href="https://lifefindsitsway.wiki/web3/audit/Heimdall-rs/" rel="canonical"/>
<link href="../../defi/flash_loan_attack_260101/" rel="prev"/>
<link href="../../project/HybridRandomDiceGame/" rel="next"/>
<link href="../../../assets/images/favicon.png" rel="icon"/>
<meta content="mkdocs-1.6.1, mkdocs-material-9.5.34" name="generator"/>
<title>Claude Code + Heimdall-rs 深度逆向 EVM 智能合约 - Life's Web3 开发指南</title>
<link href="../../../assets/stylesheets/main.35f28582.min.css" rel="stylesheet"/>
<link href="../../../assets/stylesheets/palette.06af60db.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto+Slab:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto Slab";--md-code-font:"Roboto Mono"}</style>
<link href="../../../css/heti.css" rel="stylesheet"/>
<link href="../../../assets/stylesheets/mathjax-custom.css" rel="stylesheet"/>
<script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-KJB4RXSKZG"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-KJB4RXSKZG",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-KJB4RXSKZG",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
<script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
</head>
<body data-md-color-accent="deep-purple" data-md-color-primary="light-blue" data-md-color-scheme="default" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#claude-code-heimdall-rs-evm">
          跳转至
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header md-header--shadow" data-md-component="header">
<nav aria-label="页眉" class="md-header__inner md-grid">
<a aria-label="Life's Web3 开发指南" class="md-header__button md-logo" data-md-component="logo" href="../../.." title="Life's Web3 开发指南">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            Life's Web3 开发指南
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Claude Code + Heimdall-rs 深度逆向 EVM 智能合约
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="deep-purple" data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary="light-blue" data-md-color-scheme="default" id="__palette_0" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to dark mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"></path></svg>
</label>
<input aria-label="Switch to light mode" class="md-option" data-md-color-accent="deep-purple" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="black" data-md-color-scheme="slate" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_0" hidden="" title="Switch to light mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"></path></svg>
</label>
</form>
<script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="搜索" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="搜索" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
</label>
<nav aria-label="查找" class="md-search__options">
<a aria-label="分享" class="md-search__icon md-icon" data-clipboard="" data-clipboard-text="" data-md-component="search-share" href="javascript:void(0)" tabindex="-1" title="分享">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"></path></svg>
</a>
<button aria-label="清空当前内容" class="md-search__icon md-icon" tabindex="-1" title="清空当前内容" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
</button>
</nav>
<div class="md-search__suggest" data-md-component="search-suggest"></div>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="" tabindex="0">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/lifefindsitsway/web3-tutorials" title="前往仓库">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg>
</div>
<div class="md-source__repository">
    web3-tutorials
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="导航栏" class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="Life's Web3 开发指南" class="md-nav__button md-logo" data-md-component="logo" href="../../.." title="Life's Web3 开发指南">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg>
</a>
    Life's Web3 开发指南
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/lifefindsitsway/web3-tutorials" title="前往仓库">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg>
</div>
<div class="md-source__repository">
    web3-tutorials
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../..">
<span class="md-ellipsis">
    Welcome to My Blog
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../changelog/">
<span class="md-ellipsis">
    更新日志
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
<span class="md-ellipsis">
    区块链基础
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_3">
<span class="md-nav__icon md-icon"></span>
            区块链基础
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../blockchain/the_evolution_of_bitcoin_240213/">
<span class="md-ellipsis">
    比特币的诞生历程
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../blockchain/blockchain_research_notes_2310/">
<span class="md-ellipsis">
    北京大学肖臻老师《区块链技术与应用》
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../blockchain/from_blockchain_to_the_metaverse_and_web3_220528/">
<span class="md-ellipsis">
    从区块链出发的元宇宙与Web3
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../blockchain/blockchain_and_innovative_thinking_notes_2101/">
<span class="md-ellipsis">
    南京大学公开课《区块链与创新思维》
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
<span class="md-ellipsis">
    Web3开发
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_4">
<span class="md-nav__icon md-icon"></span>
            Web3开发
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../dapp/gas_optimization_guide_part1_gas_mechanism/">
<span class="md-ellipsis">
    Gas 优化指南（一）：Gas 机制原理
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../dapp/gas_optimization_guide_part2_eip1559_transaction_analysis/">
<span class="md-ellipsis">
    Gas 优化指南（二）：EIP-1559 交易解析
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../dapp/gas_optimization_guide_part3_storage_optimization/">
<span class="md-ellipsis">
    Gas 优化指南（三）：存储优化
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../dapp/gas_optimization_guide_part4_computation_optimization/">
<span class="md-ellipsis">
    Gas 优化指南（四）：计算优化
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../dapp/gas_optimization_guide_part5_gas_measurement/">
<span class="md-ellipsis">
    Gas 优化指南（五）：Gas 评估与测量
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../dapp/solidity_proxy_upgrade_series_part1/">
<span class="md-ellipsis">
    代理合约与可升级合约系列（一）：为什么需要可升级？
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../dapp/solidity_proxy_upgrade_series_part2/">
<span class="md-ellipsis">
    代理合约与可升级合约系列（二）：透明代理 vs UUPS
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../dapp/solidity_contract_call_part1_240521/">
<span class="md-ellipsis">
    Solidity 合约间调用（一）：四种方式调用已部署合约
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../dapp/solidity_contract_call_part2_240523/">
<span class="md-ellipsis">
    Solidity 合约间调用（二）：底层调用与 calldata 详解
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../dapp/solidity_contract_call_part3_240527/">
<span class="md-ellipsis">
    Solidity 合约间调用（三）：创建合约的两种方式：create 与 create2
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../dapp/nft_development/">
<span class="md-ellipsis">
    ERC-721 NFT 实战：合约编写、部署、Mint 全流程
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../dapp/hardhat_tutorial_240415/">
<span class="md-ellipsis">
    Hardhat 入门指南（25年更新版）
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../dapp/evm_fundamentals_part1_from_transactions_to_bytecode_240410/">
<span class="md-ellipsis">
    EVM 基础原理（一）：从交易到字节码
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../dapp/evm_fundamentals_part2_data_regions_and_contract_execution_240411/">
<span class="md-ellipsis">
    EVM 基础原理（二）：数据区域与合约执行
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../dapp/evm_fundamentals_part3_abi_encoding_and_low-level_calls_240413/">
<span class="md-ellipsis">
    EVM 基础原理（三）：ABI 编码与底层调用
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../dapp/address_240321/">
<span class="md-ellipsis">
    Solidity 地址类型 &amp; 常见用法全攻略
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../dapp/ethereum_address_size_240320/">
<span class="md-ellipsis">
    为什么以太坊地址是 20 字节？从私钥到地址的全解析
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
<span class="md-ellipsis">
    DeFi
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_5_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_5">
<span class="md-nav__icon md-icon"></span>
            DeFi
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../defi/defi_course_2024_edition_notes/">
<span class="md-ellipsis">
    《DeFi 课程（2024 版）》学习记录
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../defi/uniswap_v2_price_precision_240610/">
<span class="md-ellipsis">
    Uniswap V2 价格精度解析
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../defi/uniswap_v2_twap_oracle_240614/">
<span class="md-ellipsis">
    Uniswap V2 TWAP 预言机（数学推导 &amp; 源码解读）
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../defi/flash_loan_attack_260101/">
<span class="md-ellipsis">
    闪电贷：从原理到攻击演示
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
<span class="md-ellipsis">
    合约审计
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_6_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_6">
<span class="md-nav__icon md-icon"></span>
            合约审计
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
<span class="md-ellipsis">
    Claude Code + Heimdall-rs 深度逆向 EVM 智能合约
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
<span class="md-ellipsis">
    Claude Code + Heimdall-rs 深度逆向 EVM 智能合约
  </span>
</a>
<nav aria-label="目录" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      目录
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#_1">
<span class="md-ellipsis">
      安装指南
    </span>
</a>
<nav aria-label="安装指南" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#_2">
<span class="md-ellipsis">
      方式一：官方标准安装
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#wsl2-ubuntu-2404-v2rayn">
<span class="md-ellipsis">
      方式二：WSL2 Ubuntu 24.04 + v2rayN 代理安装（推荐国内用户）
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#bifrost">
<span class="md-ellipsis">
      bifrost 进阶用法
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_3">
<span class="md-ellipsis">
      主要功能模块
    </span>
</a>
<nav aria-label="主要功能模块" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#1-heimdall-decompile">
<span class="md-ellipsis">
      1. 反编译 — heimdall decompile
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#2-heimdall-disassemble">
<span class="md-ellipsis">
      2. 反汇编 — heimdall disassemble
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#3-heimdall-cfg">
<span class="md-ellipsis">
      3. 控制流图 — heimdall cfg
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#4-heimdall-decode">
<span class="md-ellipsis">
      4. 交易解码 — heimdall decode
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#5-heimdall-dump">
<span class="md-ellipsis">
      5. 存储导出 — heimdall dump
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#6-heimdall-inspect">
<span class="md-ellipsis">
      6. 交易检查 — heimdall inspect
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#eth">
<span class="md-ellipsis">
      实战演示：逆向分析一个 ETH 金库合约
    </span>
</a>
<nav aria-label="实战演示：逆向分析一个 ETH 金库合约" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#_4">
<span class="md-ellipsis">
      演示合约设计
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#decompile">
<span class="md-ellipsis">
      分析结果一：反编译（Decompile）— 还原函数接口
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#disassemble">
<span class="md-ellipsis">
      分析结果二：反汇编（Disassemble）— 操作码安全扫描
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#cfg">
<span class="md-ellipsis">
      分析结果三：控制流图（CFG）— 可视化逻辑结构
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#dump">
<span class="md-ellipsis">
      分析结果四：存储导出（Dump）— 读取链上状态
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#decode-batchtransfer">
<span class="md-ellipsis">
      分析结果五：交易解码（Decode）— 解析 batchTransfer 调用
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#inspect-withdraw">
<span class="md-ellipsis">
      分析结果六：交易检查（Inspect）— 追踪 withdraw 内部调用
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_5">
<span class="md-ellipsis">
      安全发现总结
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_6">
<span class="md-ellipsis">
      使用场景
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_7">
<span class="md-ellipsis">
      技术优势
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_8">
<span class="md-ellipsis">
      附录
    </span>
</a>
<nav aria-label="附录" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#a-ai-agent-prompt">
<span class="md-ellipsis">
      A. AI Agent 分析 Prompt 模板
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#b">
<span class="md-ellipsis">
      B. 生成的分析文件
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#c">
<span class="md-ellipsis">
      C. 参考资料
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_7" type="checkbox"/>
<label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
<span class="md-ellipsis">
    Projects
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_7_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_7">
<span class="md-nav__icon md-icon"></span>
            Projects
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../project/HybridRandomDiceGame/">
<span class="md-ellipsis">
    生产级骰子游戏（HybridRandomDiceGame）
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="目录" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      目录
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#_1">
<span class="md-ellipsis">
      安装指南
    </span>
</a>
<nav aria-label="安装指南" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#_2">
<span class="md-ellipsis">
      方式一：官方标准安装
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#wsl2-ubuntu-2404-v2rayn">
<span class="md-ellipsis">
      方式二：WSL2 Ubuntu 24.04 + v2rayN 代理安装（推荐国内用户）
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#bifrost">
<span class="md-ellipsis">
      bifrost 进阶用法
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_3">
<span class="md-ellipsis">
      主要功能模块
    </span>
</a>
<nav aria-label="主要功能模块" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#1-heimdall-decompile">
<span class="md-ellipsis">
      1. 反编译 — heimdall decompile
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#2-heimdall-disassemble">
<span class="md-ellipsis">
      2. 反汇编 — heimdall disassemble
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#3-heimdall-cfg">
<span class="md-ellipsis">
      3. 控制流图 — heimdall cfg
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#4-heimdall-decode">
<span class="md-ellipsis">
      4. 交易解码 — heimdall decode
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#5-heimdall-dump">
<span class="md-ellipsis">
      5. 存储导出 — heimdall dump
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#6-heimdall-inspect">
<span class="md-ellipsis">
      6. 交易检查 — heimdall inspect
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#eth">
<span class="md-ellipsis">
      实战演示：逆向分析一个 ETH 金库合约
    </span>
</a>
<nav aria-label="实战演示：逆向分析一个 ETH 金库合约" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#_4">
<span class="md-ellipsis">
      演示合约设计
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#decompile">
<span class="md-ellipsis">
      分析结果一：反编译（Decompile）— 还原函数接口
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#disassemble">
<span class="md-ellipsis">
      分析结果二：反汇编（Disassemble）— 操作码安全扫描
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#cfg">
<span class="md-ellipsis">
      分析结果三：控制流图（CFG）— 可视化逻辑结构
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#dump">
<span class="md-ellipsis">
      分析结果四：存储导出（Dump）— 读取链上状态
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#decode-batchtransfer">
<span class="md-ellipsis">
      分析结果五：交易解码（Decode）— 解析 batchTransfer 调用
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#inspect-withdraw">
<span class="md-ellipsis">
      分析结果六：交易检查（Inspect）— 追踪 withdraw 内部调用
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_5">
<span class="md-ellipsis">
      安全发现总结
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_6">
<span class="md-ellipsis">
      使用场景
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_7">
<span class="md-ellipsis">
      技术优势
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_8">
<span class="md-ellipsis">
      附录
    </span>
</a>
<nav aria-label="附录" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#a-ai-agent-prompt">
<span class="md-ellipsis">
      A. AI Agent 分析 Prompt 模板
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#b">
<span class="md-ellipsis">
      B. 生成的分析文件
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#c">
<span class="md-ellipsis">
      C. 参考资料
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1 id="claude-code-heimdall-rs-evm"><span>Claude Code + Heimdall-rs<span class="heti-spacing"> </span></span>深度逆向<span class="heti-skip"><span class="heti-spacing"> </span>EVM<span class="heti-spacing"> </span></span>智能合约<a class="headerlink" href="#claude-code-heimdall-rs-evm" title="Permanent link"><span><span class="heti-spacing"> </span>¶</span></a></h1>
<div style="margin-top: -30px; font-size: 0.75em; opacity: 0.7;">
<p><span class="twemoji"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 2A10 10 0 0 0 2 12a10 10 0 0 0 10 10 10 10 0 0 0 10-10h-2a8 8 0 0 1-8 8 8 8 0 0 1-8-8 8 8 0 0 1 8-8zm6.78 1a.7.7 0 0 0-.48.2l-1.22 1.21 2.5 2.5L20.8 5.7c.26-.26.26-.7 0-.95L19.25 3.2c-.13-.13-.3-.2-.47-.2m-2.41 2.12L9 12.5V15h2.5l7.37-7.38z"></path></svg></span> 约<span class="heti-skip"><span class="heti-spacing"> </span>4852<span class="heti-spacing"> </span></span>个字 <span class="twemoji"><svg viewbox="0 0 640 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M392.8 1.2c-17-4.9-34.7 5-39.6 22l-128 448c-4.9 17 5 34.7 22 39.6s34.7-5 39.6-22l128-448c4.9-17-5-34.7-22-39.6m80.6 120.1c-12.5 12.5-12.5 32.8 0 45.3l89.3 89.4-89.4 89.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l112-112c12.5-12.5 12.5-32.8 0-45.3l-112-112c-12.5-12.5-32.8-12.5-45.3 0zm-306.7 0c-12.5-12.5-32.8-12.5-45.3 0l-112 112c-12.5 12.5-12.5 32.8 0 45.3l112 112c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256l89.4-89.4c12.5-12.5 12.5-32.8 0-45.3"></path></svg></span> <span>254<span class="heti-spacing"> </span></span>行代码 <span class="twemoji"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 20c4.42 0 8-3.58 8-8s-3.58-8-8-8-8 3.58-8 8 3.58 8 8 8m0-18c5.5 0 10 4.5 10 10s-4.5 10-10 10C6.47 22 2 17.5 2 12S6.5 2 12 2m.5 11H11V7h1.5v4.26l3.7-2.13.75 1.3z"></path></svg></span> 预计阅读时间<span class="heti-skip"><span class="heti-spacing"> </span>19<span class="heti-spacing"> </span></span>分钟</p>
</div>
<blockquote>
<p>在<span class="heti-skip"><span class="heti-spacing"> </span>DeFi<span class="heti-spacing"> </span></span>的<span class="heti-skip"><span class="heti-spacing"> </span>"<span class="heti-spacing"> </span></span>黑暗森林<span class="heti-skip"><span class="heti-spacing"> </span>"<span class="heti-spacing"> </span></span>中，你经常会遇到这样的场景：一个管理着数百万美元资金的合约，在<span class="heti-skip"><span class="heti-spacing"> </span>Etherscan<span class="heti-spacing"> </span></span>上却只能看到一堆不可读的十六进制字节码——没有源码，没有<span><span class="heti-spacing"> </span>ABI</span>，没有文档。它是安全的金库，还是精心伪装的<span><span class="heti-spacing"> </span>Rug Pull</span>？字节码是你唯一的线索。<span>Heimdall-rs<span class="heti-spacing"> </span></span>正是为这类场景而生的武器，本文将完整介绍这款工具的安装、使用，并通过一个实战案例展示如何配合<span class="heti-skip"><span class="heti-spacing"> </span>Claude Code<span class="heti-spacing"> </span></span>对未开源合约进行黑盒审计。</p>
</blockquote>
<p><span>Heimdall-rs<span class="heti-spacing"> </span></span>是一款使用<span class="heti-skip"><span class="heti-spacing"> </span>Rust<span class="heti-spacing"> </span></span>编写的高性能<span class="heti-skip"><span class="heti-spacing"> </span>EVM<span class="heti-spacing"> </span></span>智能合约分析工具包，专注于<strong>字节码分析</strong>与<strong>逆向工程</strong>。它可以将不可读的字节码还原为可理解的伪代码、操作码序列和可视化控制流图，目前支持六大核心操作：</p>
<ul>
<li>字节码反汇编（Disassemble）</li>
<li>控制流图生成（CFG）</li>
<li>智能合约反编译（Decompile）</li>
<li>合约存储导出（Dump）</li>
<li>交易<span class="heti-skip"><span class="heti-spacing"> </span>Calldata<span class="heti-spacing"> </span></span>解码（Decode）</li>
<li>交易<span class="heti-skip"><span class="heti-spacing"> </span>Trace<span class="heti-spacing"> </span></span>解码（Inspect）</li>
</ul>
<p>截至撰写本文时，最新版本为<span><span class="heti-spacing"> </span>v0.9.2</span>。建议通过 <code>bifrost</code> 定期检查并安装最新版本以获得最佳的反编译效果。</p>
<p><span>Github<span class="heti-spacing"> </span></span>仓库：<a href="https://github.com/Jon-Becker/heimdall-rs/">https://github.com/Jon-Becker/heimdall-rs/</a></p>
<h2 id="_1">安装指南<a class="headerlink" href="#_1" title="Permanent link"><span><span class="heti-spacing"> </span>¶</span></a></h2>
<p><span>Heimdall-rs<span class="heti-spacing"> </span></span>通过其专用的安装管理器 <strong>bifrost</strong> 来安装和更新。下面分别介绍官方标准流程和针对国内网络环境（<span>WSL2 +<span class="heti-spacing"> </span></span>代理）的实战流程。</p>
<p><strong>前置条件：安装<span class="heti-skip"><span class="heti-spacing"> </span>Rust<span class="heti-spacing"> </span></span>与<span><span class="heti-spacing"> </span>Cargo</span></strong></p>
<p>如果你的系统尚未安装<span class="heti-skip"><span class="heti-spacing"> </span>Rust<span class="heti-spacing"> </span></span>工具链，请先执行以下命令：</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-0-1" id="__codelineno-0-1" name="__codelineno-0-1"></a>curl<span class="w"> </span>https://sh.rustup.rs<span class="w"> </span>-sSf<span class="w"> </span><span class="p">|</span><span class="w"> </span>sh
</code></pre></div>
<p>安装完成后，运行 <code>source ~/.cargo/env</code> 或新开一个终端以激活环境变量。</p>
<h3 id="_2">方式一：官方标准安装<a class="headerlink" href="#_2" title="Permanent link"><span><span class="heti-spacing"> </span>¶</span></a></h3>
<p>在网络畅通的环境下，按照官方文档两步即可完成安装：</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-1-1" id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="c1"># 第一步：安装 bifrost（Heimdall 的安装/更新管理器）</span>
<a href="#__codelineno-1-2" id="__codelineno-1-2" name="__codelineno-1-2"></a>curl<span class="w"> </span>-L<span class="w"> </span>http://get.heimdall.rs<span class="w"> </span><span class="p">|</span><span class="w"> </span>bash
<a href="#__codelineno-1-3" id="__codelineno-1-3" name="__codelineno-1-3"></a>
<a href="#__codelineno-1-4" id="__codelineno-1-4" name="__codelineno-1-4"></a><span class="c1"># 第二步：新开终端，运行 bifrost 安装 Heimdall 核心程序</span>
<a href="#__codelineno-1-5" id="__codelineno-1-5" name="__codelineno-1-5"></a>bifrost
</code></pre></div>
<p>安装完成后，新开终端即可使用 <code>heimdall</code> 命令。</p>
<h3 id="wsl2-ubuntu-2404-v2rayn">方式二：<span>WSL2 Ubuntu 24.04 + v2rayN<span class="heti-spacing"> </span></span>代理安装（推荐国内用户）<a class="headerlink" href="#wsl2-ubuntu-2404-v2rayn" title="Permanent link">¶</a></h3>
<p>在<span class="heti-skip"><span class="heti-spacing"> </span>WSL2<span class="heti-spacing"> </span></span>环境下，<code>get.heimdall.rs</code> 会重定向到<span><span class="heti-spacing"> </span>GitHub / Google Storage</span>，直接执行会遇到<strong>网络屏蔽</strong>和<strong>缺少依赖</strong>的问题。以下是经过验证的完整安装流程。</p>
<p><strong>第一步：安装系统底层依赖</strong></p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-2-1" id="__codelineno-2-1" name="__codelineno-2-1"></a>sudo<span class="w"> </span>apt<span class="w"> </span>update
<a href="#__codelineno-2-2" id="__codelineno-2-2" name="__codelineno-2-2"></a>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>build-essential<span class="w"> </span>pkg-config<span class="w"> </span>libssl-dev<span class="w"> </span>-y
</code></pre></div>
<p><strong>第二步：配置代理并安装<span><span class="heti-spacing"> </span>bifrost</span></strong></p>
<p><span>WSL2<span class="heti-spacing"> </span></span>在网络层被视为局域网设备，因此需要通过<span class="heti-skip"><span class="heti-spacing"> </span>Windows<span class="heti-spacing"> </span></span>主机的代理来访问外网。请确保<span class="heti-skip"><span class="heti-spacing"> </span>v2rayN<span class="heti-spacing"> </span></span>已开启 <strong><span>"<span class="heti-spacing"> </span></span>允许来自局域网的连接（Allow LAN）"</strong> 选项。</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-3-1" id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="c1"># 动态获取 WSL2 的网关地址（即 Windows 主机 IP）</span>
<a href="#__codelineno-3-2" id="__codelineno-3-2" name="__codelineno-3-2"></a><span class="nb">export</span><span class="w"> </span><span class="nv">hostip</span><span class="o">=</span><span class="k">$(</span>ip<span class="w"> </span>route<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>default<span class="w"> </span><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span><span class="s1">'{print $3}'</span><span class="k">)</span>
<a href="#__codelineno-3-3" id="__codelineno-3-3" name="__codelineno-3-3"></a><span class="nb">export</span><span class="w"> </span><span class="nv">proxy_port</span><span class="o">=</span><span class="m">10809</span><span class="w">  </span><span class="c1"># v2rayN 默认 HTTP 代理端口，根据实际情况修改</span>
<a href="#__codelineno-3-4" id="__codelineno-3-4" name="__codelineno-3-4"></a><span class="nb">export</span><span class="w"> </span><span class="nv">http_proxy</span><span class="o">=</span><span class="s2">"http://</span><span class="si">${</span><span class="nv">hostip</span><span class="si">}</span><span class="s2">:</span><span class="si">${</span><span class="nv">proxy_port</span><span class="si">}</span><span class="s2">"</span>
<a href="#__codelineno-3-5" id="__codelineno-3-5" name="__codelineno-3-5"></a><span class="nb">export</span><span class="w"> </span><span class="nv">https_proxy</span><span class="o">=</span><span class="s2">"http://</span><span class="si">${</span><span class="nv">hostip</span><span class="si">}</span><span class="s2">:</span><span class="si">${</span><span class="nv">proxy_port</span><span class="si">}</span><span class="s2">"</span>
<a href="#__codelineno-3-6" id="__codelineno-3-6" name="__codelineno-3-6"></a>
<a href="#__codelineno-3-7" id="__codelineno-3-7" name="__codelineno-3-7"></a><span class="c1"># 执行 bifrost 安装脚本</span>
<a href="#__codelineno-3-8" id="__codelineno-3-8" name="__codelineno-3-8"></a>curl<span class="w"> </span>-L<span class="w"> </span>http://get.heimdall.rs<span class="w"> </span><span class="p">|</span><span class="w"> </span>bash
</code></pre></div>
<p><strong>第三步：激活环境变量并安装<span><span class="heti-spacing"> </span>Heimdall</span></strong></p>
<p><span>bifrost<span class="heti-spacing"> </span></span>安装完成后会自动将自身添加到 <code>~/.bashrc</code>。你需要刷新环境，然后运行<span class="heti-skip"><span class="heti-spacing"> </span>bifrost<span class="heti-spacing"> </span></span>来真正安装<span class="heti-skip"><span class="heti-spacing"> </span>Heimdall<span class="heti-spacing"> </span></span>核心程序：</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-4-1" id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="c1"># 刷新当前终端的环境变量</span>
<a href="#__codelineno-4-2" id="__codelineno-4-2" name="__codelineno-4-2"></a><span class="nb">source</span><span class="w"> </span>~/.bashrc
<a href="#__codelineno-4-3" id="__codelineno-4-3" name="__codelineno-4-3"></a>
<a href="#__codelineno-4-4" id="__codelineno-4-4" name="__codelineno-4-4"></a><span class="c1"># 运行 bifrost 安装 heimdall 核心程序</span>
<a href="#__codelineno-4-5" id="__codelineno-4-5" name="__codelineno-4-5"></a><span class="c1"># 注意：这一步 bifrost 会下载 heimdall 二进制文件，同样需要保持代理开启</span>
<a href="#__codelineno-4-6" id="__codelineno-4-6" name="__codelineno-4-6"></a>bifrost
</code></pre></div>
<p><strong>第四步：验证安装</strong></p>
<p>安装完成后，新开一个终端或再次 <code>source ~/.bashrc</code>，验证版本：</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-5-1" id="__codelineno-5-1" name="__codelineno-5-1"></a>heimdall<span class="w"> </span>--version
<a href="#__codelineno-5-2" id="__codelineno-5-2" name="__codelineno-5-2"></a><span class="c1"># 预期输出：heimdall 0.9.x 或更新版本</span>
</code></pre></div>
<h3 id="bifrost"><span>bifrost<span class="heti-spacing"> </span></span>进阶用法<a class="headerlink" href="#bifrost" title="Permanent link"><span><span class="heti-spacing"> </span>¶</span></a></h3>
<p><span>bifrost<span class="heti-spacing"> </span></span>不仅用于首次安装，还是<span class="heti-skip"><span class="heti-spacing"> </span>Heimdall<span class="heti-spacing"> </span></span>的版本管理器：</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-6-1" id="__codelineno-6-1" name="__codelineno-6-1"></a><span class="c1"># 查看所有可用版本</span>
<a href="#__codelineno-6-2" id="__codelineno-6-2" name="__codelineno-6-2"></a>bifrost<span class="w"> </span>-l
<a href="#__codelineno-6-3" id="__codelineno-6-3" name="__codelineno-6-3"></a>
<a href="#__codelineno-6-4" id="__codelineno-6-4" name="__codelineno-6-4"></a><span class="c1"># 安装指定版本</span>
<a href="#__codelineno-6-5" id="__codelineno-6-5" name="__codelineno-6-5"></a>bifrost<span class="w"> </span>-v<span class="w"> </span><span class="m">0</span>.9.2
<a href="#__codelineno-6-6" id="__codelineno-6-6" name="__codelineno-6-6"></a>
<a href="#__codelineno-6-7" id="__codelineno-6-7" name="__codelineno-6-7"></a><span class="c1"># 安装开发分支（用于测试新功能）</span>
<a href="#__codelineno-6-8" id="__codelineno-6-8" name="__codelineno-6-8"></a>bifrost<span class="w"> </span>-v<span class="w"> </span>feat/decompile
</code></pre></div>
<h2 id="_3">主要功能模块<a class="headerlink" href="#_3" title="Permanent link"><span><span class="heti-spacing"> </span>¶</span></a></h2>
<p><span>Heimdall-rs<span class="heti-spacing"> </span></span>采用模块化设计，每个功能对应一个子命令。所有模块共享以下通用选项：</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-7-1" id="__codelineno-7-1" name="__codelineno-7-1"></a>-v          提高输出详细程度（可叠加使用，如 -vvv 表示最详细）
<a href="#__codelineno-7-2" id="__codelineno-7-2" name="__codelineno-7-2"></a>-q          静默模式，隐藏所有输出
<a href="#__codelineno-7-3" id="__codelineno-7-3" name="__codelineno-7-3"></a>-r &lt;URL&gt;    指定 RPC 节点地址（支持所有 EVM 兼容链）
<a href="#__codelineno-7-4" id="__codelineno-7-4" name="__codelineno-7-4"></a>-o &lt;PATH&gt;   指定输出文件或目录
</code></pre></div>
<h3 id="1-heimdall-decompile"><span>1.<span class="heti-spacing"> </span></span>反编译 — <code>heimdall decompile</code><a class="headerlink" href="#1-heimdall-decompile" title="Permanent link">¶</a></h3>
<p>这是<span class="heti-skip"><span class="heti-spacing"> </span>Heimdall<span class="heti-spacing"> </span></span>最核心也最强大的功能。它能将<span class="heti-skip"><span class="heti-spacing"> </span>EVM<span class="heti-spacing"> </span></span>字节码转换成高度可读的伪代码（类似<span class="heti-skip"><span class="heti-spacing"> </span>Solidity<span class="heti-spacing"> </span></span>的风格<heti-adjacent class="heti-adjacent-half">）</heti-adjacent>，即使在没有<span class="heti-skip"><span class="heti-spacing"> </span>ABI<span class="heti-spacing"> </span></span>的情况下也能高度还原合约逻辑。</p>
<p><strong>核心能力：</strong> 自动识别函数选择器和签名、解析控制流（If/Else、循环<heti-adjacent class="heti-adjacent-half">）</heti-adjacent>、推断变量类型和存储布局、生成对应的<span class="heti-skip"><span class="heti-spacing"> </span>ABI<span class="heti-spacing"> </span></span>文件。</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-8-1" id="__codelineno-8-1" name="__codelineno-8-1"></a><span class="c1"># 通过链上合约地址反编译（需要 RPC）</span>
<a href="#__codelineno-8-2" id="__codelineno-8-2" name="__codelineno-8-2"></a>heimdall<span class="w"> </span>decompile<span class="w"> </span>&lt;CONTRACT_ADDRESS&gt;<span class="w"> </span>-r<span class="w"> </span>&lt;RPC_URL&gt;<span class="w"> </span>-vvv
<a href="#__codelineno-8-3" id="__codelineno-8-3" name="__codelineno-8-3"></a>
<a href="#__codelineno-8-4" id="__codelineno-8-4" name="__codelineno-8-4"></a><span class="c1"># 通过本地字节码反编译</span>
<a href="#__codelineno-8-5" id="__codelineno-8-5" name="__codelineno-8-5"></a>heimdall<span class="w"> </span>decompile<span class="w"> </span>&lt;BYTECODE_HEX&gt;
</code></pre></div>
<p><strong>典型场景：</strong> 分析黑客攻击后的恶意合约、审查未开源的第三方协议、探索闭源交易机器人的策略逻辑。</p>
<h3 id="2-heimdall-disassemble"><span>2.<span class="heti-spacing"> </span></span>反汇编 — <code>heimdall disassemble</code><a class="headerlink" href="#2-heimdall-disassemble" title="Permanent link">¶</a></h3>
<p>将字节码转换成底层<span class="heti-skip"><span class="heti-spacing"> </span>EVM<span class="heti-spacing"> </span></span>操作码（Opcodes）序列，如 <code>PUSH1</code>、<code>SSTORE</code>、<code>DELEGATECALL</code> 等。相比于简单的反汇编工具，<span>Heimdall<span class="heti-spacing"> </span></span>提供了更好的格式化输出，方便分析底层执行流程。</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-9-1" id="__codelineno-9-1" name="__codelineno-9-1"></a>heimdall<span class="w"> </span>disassemble<span class="w"> </span>&lt;CONTRACT_ADDRESS&gt;<span class="w"> </span>-r<span class="w"> </span>&lt;RPC_URL&gt;
</code></pre></div>
<p><strong>典型场景：</strong> 理解合约的底层执行逻辑、辅助手动安全审计、学习<span class="heti-skip"><span class="heti-spacing"> </span>EVM<span class="heti-spacing"> </span></span>操作码。</p>
<h3 id="3-heimdall-cfg"><span>3.<span class="heti-spacing"> </span></span>控制流图 — <code>heimdall cfg</code><a class="headerlink" href="#3-heimdall-cfg" title="Permanent link">¶</a></h3>
<p>生成合约逻辑的可视化控制流图（Control Flow Graph<heti-adjacent class="heti-adjacent-half">）</heti-adjacent>，输出为<span class="heti-skip"><span class="heti-spacing"> </span>Graphviz<span class="heti-spacing"> </span></span>的 <code>.dot</code> 文件，也可以通过 <code>--format</code> 参数转换为<span class="heti-skip"><span class="heti-spacing"> </span>SVG<span class="heti-spacing"> </span></span>或<span class="heti-skip"><span class="heti-spacing"> </span>PNG<span class="heti-spacing"> </span></span>等格式。</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-10-1" id="__codelineno-10-1" name="__codelineno-10-1"></a><span class="c1"># 生成 .dot 文件</span>
<a href="#__codelineno-10-2" id="__codelineno-10-2" name="__codelineno-10-2"></a>heimdall<span class="w"> </span>cfg<span class="w"> </span>&lt;CONTRACT_ADDRESS&gt;<span class="w"> </span>-r<span class="w"> </span>&lt;RPC_URL&gt;<span class="w"> </span>-vvv
<a href="#__codelineno-10-3" id="__codelineno-10-3" name="__codelineno-10-3"></a>
<a href="#__codelineno-10-4" id="__codelineno-10-4" name="__codelineno-10-4"></a><span class="c1"># 直接生成 SVG 文件（方便在浏览器中查看）</span>
<a href="#__codelineno-10-5" id="__codelineno-10-5" name="__codelineno-10-5"></a>heimdall<span class="w"> </span>cfg<span class="w"> </span>&lt;CONTRACT_ADDRESS&gt;<span class="w"> </span>-r<span class="w"> </span>&lt;RPC_URL&gt;<span class="w"> </span>-vvv<span class="w"> </span>--format<span class="w"> </span>svg
</code></pre></div>
<p><strong>典型场景：</strong> 通过图形化方式一眼识别异常的逻辑分支或隐藏后门、辅助安全审计人员理解合约跳转逻辑（JUMP/JUMPI<heti-adjacent class="heti-adjacent-half">）</heti-adjacent>。</p>
<h3 id="4-heimdall-decode"><span>4.<span class="heti-spacing"> </span></span>交易解码 — <code>heimdall decode</code><a class="headerlink" href="#4-heimdall-decode" title="Permanent link">¶</a></h3>
<p>解码交易的<span><span class="heti-spacing"> </span>Calldata</span>（输入数据<heti-adjacent class="heti-adjacent-half">）</heti-adjacent>。当你有一串未知的交易数据时，它能帮你解析出调用的函数及其参数，无需提供<span><span class="heti-spacing"> </span>ABI</span>。该模块使用<span class="heti-skip"><span class="heti-spacing"> </span>samczsun<span class="heti-spacing"> </span></span>的函数签名库来匹配和解码函数选择器。</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-11-1" id="__codelineno-11-1" name="__codelineno-11-1"></a><span class="c1"># 通过交易哈希解码</span>
<a href="#__codelineno-11-2" id="__codelineno-11-2" name="__codelineno-11-2"></a>heimdall<span class="w"> </span>decode<span class="w"> </span>&lt;TX_HASH&gt;<span class="w"> </span>-r<span class="w"> </span>&lt;RPC_URL&gt;
<a href="#__codelineno-11-3" id="__codelineno-11-3" name="__codelineno-11-3"></a>
<a href="#__codelineno-11-4" id="__codelineno-11-4" name="__codelineno-11-4"></a><span class="c1"># 解码原始 calldata</span>
<a href="#__codelineno-11-5" id="__codelineno-11-5" name="__codelineno-11-5"></a>heimdall<span class="w"> </span>decode<span class="w"> </span>&lt;RAW_CALLDATA_HEX&gt;<span class="w"> </span>-r<span class="w"> </span>&lt;RPC_URL&gt;
<a href="#__codelineno-11-6" id="__codelineno-11-6" name="__codelineno-11-6"></a>
<a href="#__codelineno-11-7" id="__codelineno-11-7" name="__codelineno-11-7"></a><span class="c1"># 解码合约构造函数参数</span>
<a href="#__codelineno-11-8" id="__codelineno-11-8" name="__codelineno-11-8"></a>heimdall<span class="w"> </span>decode<span class="w"> </span>&lt;CONTRACT_CREATION_CODE&gt;<span class="w"> </span>--constructor<span class="w"> </span>-r<span class="w"> </span>&lt;RPC_URL&gt;
</code></pre></div>
<p><strong>典型场景：</strong> 分析可疑交易的具体行为、理解复杂协议（如<span><span class="heti-spacing"> </span>Seaport</span>）的交互参数、调试合约调用。</p>
<h3 id="5-heimdall-dump"><span>5.<span class="heti-spacing"> </span></span>存储导出 — <code>heimdall dump</code><a class="headerlink" href="#5-heimdall-dump" title="Permanent link">¶</a></h3>
<p>导出指定合约在特定区块范围内的所有存储槽（Storage Slots）及其值，输出为<span class="heti-skip"><span class="heti-spacing"> </span>CSV<span class="heti-spacing"> </span></span>文件。</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-12-1" id="__codelineno-12-1" name="__codelineno-12-1"></a>heimdall<span class="w"> </span>dump<span class="w"> </span>&lt;CONTRACT_ADDRESS&gt;<span class="w"> </span>-vvv<span class="w"> </span><span class="se">\</span>
<a href="#__codelineno-12-2" id="__codelineno-12-2" name="__codelineno-12-2"></a><span class="w">  </span>--threads<span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="se">\</span>
<a href="#__codelineno-12-3" id="__codelineno-12-3" name="__codelineno-12-3"></a><span class="w">  </span>--from-block<span class="w"> </span><span class="m">15000000</span><span class="w"> </span><span class="se">\</span>
<a href="#__codelineno-12-4" id="__codelineno-12-4" name="__codelineno-12-4"></a><span class="w">  </span>--to-block<span class="w"> </span><span class="m">15000100</span>
</code></pre></div>
<p><strong>典型场景：</strong> 追踪合约状态变量的变化、分析代币余额变动、检查所有者权限变更记录。</p>
<h3 id="6-heimdall-inspect"><span>6.<span class="heti-spacing"> </span></span>交易检查 — <code>heimdall inspect</code><a class="headerlink" href="#6-heimdall-inspect" title="Permanent link">¶</a></h3>
<p>对以太坊交易进行详细检查，包括<span class="heti-skip"><span class="heti-spacing"> </span>Calldata<span class="heti-spacing"> </span></span>与<span class="heti-skip"><span class="heti-spacing"> </span>Trace<span class="heti-spacing"> </span></span>解码、日志可视化等。这是一个综合性的交易分析工具。</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-13-1" id="__codelineno-13-1" name="__codelineno-13-1"></a>heimdall<span class="w"> </span>inspect<span class="w"> </span>&lt;TRANSACTION_HASH&gt;<span class="w"> </span>-r<span class="w"> </span>&lt;RPC_URL&gt;
</code></pre></div>
<p><strong>典型场景：</strong> 对安全事件中的攻击交易进行全面分析、追踪资金流向和内部调用链。</p>
<h2 id="eth">实战演示：逆向分析一个<span class="heti-skip"><span class="heti-spacing"> </span>ETH<span class="heti-spacing"> </span></span>金库合约<a class="headerlink" href="#eth" title="Permanent link"><span><span class="heti-spacing"> </span>¶</span></a></h2>
<p>为了完整展示<span class="heti-skip"><span class="heti-spacing"> </span>Heimdall-rs<span class="heti-spacing"> </span></span>的六大功能模块在真实场景中的表现，我编写了一个教学用途的<span class="heti-skip"><span class="heti-spacing"> </span>SimpleVault<span class="heti-spacing"> </span></span>合约并将其部署到<span class="heti-skip"><span class="heti-spacing"> </span>Sepolia<span class="heti-spacing"> </span></span>测试网。这个合约<strong>不做源码验证</strong>，模拟你在链上遇到的<span class="heti-skip"><span class="heti-spacing"> </span>"<span class="heti-spacing"> </span></span>黑盒<span class="heti-skip"><span class="heti-spacing"> </span>"<span class="heti-spacing"> </span></span>场景——你只能看到字节码，需要完全依赖<span class="heti-skip"><span class="heti-spacing"> </span>Heimdall-rs<span class="heti-spacing"> </span></span>来理解它在做什么。</p>
<h3 id="_4">演示合约设计<a class="headerlink" href="#_4" title="Permanent link"><span><span class="heti-spacing"> </span>¶</span></a></h3>
<p>合约的核心功能是一个<span class="heti-skip"><span class="heti-spacing"> </span>ETH<span class="heti-spacing"> </span></span>金库，支持存款、提款、批量转账和暂停控制。选择这些功能的原因是它们能覆盖<span class="heti-skip"><span class="heti-spacing"> </span>Heimdall<span class="heti-spacing"> </span></span>的所有分析维度：</p>
<ul>
<li>多种状态变量类型（address、mapping、uint256、bool）用于演示存储导出；</li>
<li>多种函数可见性和修饰符用于演示反编译推断；</li>
<li>分支逻辑与循环结构用于演示控制流图；</li>
<li><span>ETH<span class="heti-spacing"> </span></span>转账和事件触发用于演示交易<span class="heti-skip"><span class="heti-spacing"> </span>Trace<span class="heti-spacing"> </span></span>解码；</li>
<li>动态数组参数用于演示<span class="heti-skip"><span class="heti-spacing"> </span>Calldata<span class="heti-spacing"> </span></span>解码。</li>
</ul>
<p>合约完整源码见下方折叠区域，你也可以直接跳到后续的分析结果部分。演示合约使用<span class="heti-skip"><span class="heti-spacing"> </span>Solidity 0.8.28<span class="heti-spacing"> </span></span>编译，<span>Heimdall<span class="heti-spacing"> </span></span>对高版本<span class="heti-skip"><span class="heti-spacing"> </span>Solidity<span class="heti-spacing"> </span></span>引入的自定义 <code>Error</code> 类型和 <code>Panic</code> 错误码均有良好的反编译支持。</p>
<details>
<summary>📄 <span>SimpleVault<span class="heti-spacing"> </span></span>完整源码（点击展开）</summary>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-14-1" id="__codelineno-14-1" name="__codelineno-14-1"></a><span class="c1">// SPDX-License-Identifier: MIT</span>
<a href="#__codelineno-14-2" id="__codelineno-14-2" name="__codelineno-14-2"></a><span class="k">pragma solidity</span><span class="w"> </span><span class="o">^</span><span class="k">0.8.28</span><span class="p">;</span>
<a href="#__codelineno-14-3" id="__codelineno-14-3" name="__codelineno-14-3"></a>
<a href="#__codelineno-14-4" id="__codelineno-14-4" name="__codelineno-14-4"></a><span class="cm">/**</span>
<a href="#__codelineno-14-5" id="__codelineno-14-5" name="__codelineno-14-5"></a><span class="cm"> * @title SimpleVault - Heimdall-rs 功能演示合约</span>
<a href="#__codelineno-14-6" id="__codelineno-14-6" name="__codelineno-14-6"></a><span class="cm"> * @author Lifefindsitsway</span>
<a href="#__codelineno-14-7" id="__codelineno-14-7" name="__codelineno-14-7"></a><span class="cm"> * </span>
<a href="#__codelineno-14-8" id="__codelineno-14-8" name="__codelineno-14-8"></a><span class="cm"> * 设计思路：</span>
<a href="#__codelineno-14-9" id="__codelineno-14-9" name="__codelineno-14-9"></a><span class="cm"> *   - 多种状态变量类型（address, mapping, uint256, bool）→ 演示 Dump 存储导出</span>
<a href="#__codelineno-14-10" id="__codelineno-14-10" name="__codelineno-14-10"></a><span class="cm"> *   - 多种函数可见性和修饰符（external, public, view, payable）→ 演示 Decompile 修饰符推断</span>
<a href="#__codelineno-14-11" id="__codelineno-14-11" name="__codelineno-14-11"></a><span class="cm"> *   - 分支逻辑与权限检查（require, if/else）→ 演示 CFG 控制流图 &amp; Disassemble 操作码</span>
<a href="#__codelineno-14-12" id="__codelineno-14-12" name="__codelineno-14-12"></a><span class="cm"> *   - ETH 转账 + 事件触发 → 演示 Inspect 交易 Trace 解码</span>
<a href="#__codelineno-14-13" id="__codelineno-14-13" name="__codelineno-14-13"></a><span class="cm"> *   - 多样化的函数参数类型（uint256, address, 动态数组）→ 演示 Decode Calldata 解码</span>
<a href="#__codelineno-14-14" id="__codelineno-14-14" name="__codelineno-14-14"></a><span class="cm"> */</span>
<a href="#__codelineno-14-15" id="__codelineno-14-15" name="__codelineno-14-15"></a><span class="k">contract</span><span class="w"> </span><span class="ni">SimpleVault</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-14-16" id="__codelineno-14-16" name="__codelineno-14-16"></a><span class="w">    </span><span class="c1">// ============================================================</span>
<a href="#__codelineno-14-17" id="__codelineno-14-17" name="__codelineno-14-17"></a><span class="w">    </span><span class="c1">//                       状态变量</span>
<a href="#__codelineno-14-18" id="__codelineno-14-18" name="__codelineno-14-18"></a><span class="w">    </span><span class="c1">// 这些变量会被写入链上的 Storage Slots，用于演示 heimdall dump</span>
<a href="#__codelineno-14-19" id="__codelineno-14-19" name="__codelineno-14-19"></a><span class="w">    </span><span class="c1">// ============================================================</span>
<a href="#__codelineno-14-20" id="__codelineno-14-20" name="__codelineno-14-20"></a>
<a href="#__codelineno-14-21" id="__codelineno-14-21" name="__codelineno-14-21"></a><span class="w">    </span><span class="kt">address</span><span class="w"> </span><span class="k">public </span><span class="nv">owner</span><span class="p">;</span><span class="w">           </span><span class="c1">// 合约所有者地址（slot 0）</span>
<a href="#__codelineno-14-22" id="__codelineno-14-22" name="__codelineno-14-22"></a><span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="k">public </span><span class="nv">isActive</span><span class="p">;</span><span class="w">           </span><span class="c1">// 金库是否处于激活状态（slot 1）</span>
<a href="#__codelineno-14-23" id="__codelineno-14-23" name="__codelineno-14-23"></a><span class="w">    </span><span class="kt">uint256</span><span class="w"> </span><span class="k">public </span><span class="nv">totalDeposits</span><span class="p">;</span><span class="w">   </span><span class="c1">// 累计存款总额（slot 2）</span>
<a href="#__codelineno-14-24" id="__codelineno-14-24" name="__codelineno-14-24"></a><span class="w">    </span><span class="kt">mapping</span><span class="p">(</span><span class="kt">address</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="kt">uint256</span><span class="p">)</span><span class="w"> </span><span class="kt">public</span><span class="w"> </span>balances<span class="p">;</span><span class="w">    </span><span class="c1">// 每个地址的存款余额（slot 3 起，mapping 使用 keccak256 计算实际存储位置）</span>
<a href="#__codelineno-14-25" id="__codelineno-14-25" name="__codelineno-14-25"></a>
<a href="#__codelineno-14-26" id="__codelineno-14-26" name="__codelineno-14-26"></a><span class="w">    </span><span class="c1">// ============================================================</span>
<a href="#__codelineno-14-27" id="__codelineno-14-27" name="__codelineno-14-27"></a><span class="w">    </span><span class="c1">//                         事件</span>
<a href="#__codelineno-14-28" id="__codelineno-14-28" name="__codelineno-14-28"></a><span class="w">    </span><span class="c1">// Heimdall decompile 会自动识别和还原事件声明</span>
<a href="#__codelineno-14-29" id="__codelineno-14-29" name="__codelineno-14-29"></a><span class="w">    </span><span class="c1">// Heimdall inspect 会可视化交易中触发的事件日志</span>
<a href="#__codelineno-14-30" id="__codelineno-14-30" name="__codelineno-14-30"></a><span class="w">    </span><span class="c1">// ============================================================</span>
<a href="#__codelineno-14-31" id="__codelineno-14-31" name="__codelineno-14-31"></a>
<a href="#__codelineno-14-32" id="__codelineno-14-32" name="__codelineno-14-32"></a><span class="w">    </span><span class="kt">event</span><span class="w"> </span><span class="nv">Deposited</span><span class="p">(</span><span class="kt">address</span><span class="w"> </span><span class="nv">indexed</span><span class="w"> </span>user<span class="p">,</span><span class="w"> </span><span class="kt">uint256</span><span class="w"> </span><span class="nv">amount</span><span class="p">);</span><span class="w">      </span><span class="c1">// 存款事件：记录谁存了多少 ETH</span>
<a href="#__codelineno-14-33" id="__codelineno-14-33" name="__codelineno-14-33"></a><span class="w">    </span><span class="kt">event</span><span class="w"> </span><span class="nv">Withdrawn</span><span class="p">(</span><span class="kt">address</span><span class="w"> </span><span class="nv">indexed</span><span class="w"> </span>user<span class="p">,</span><span class="w"> </span><span class="kt">uint256</span><span class="w"> </span><span class="nv">amount</span><span class="p">);</span><span class="w">      </span><span class="c1">// 提款事件：记录谁取了多少 ETH</span>
<a href="#__codelineno-14-34" id="__codelineno-14-34" name="__codelineno-14-34"></a><span class="w">    </span><span class="kt">event</span><span class="w"> </span><span class="nv">BatchTransferred</span><span class="p">(</span><span class="kt">address</span><span class="w"> </span><span class="nv">indexed</span><span class="w"> </span>from<span class="p">,</span><span class="w"> </span><span class="kt">uint256</span><span class="w"> </span><span class="nv">count</span><span class="p">);</span><span class="c1">// 批量转账事件：记录发起者和总转账笔数</span>
<a href="#__codelineno-14-35" id="__codelineno-14-35" name="__codelineno-14-35"></a><span class="w">    </span><span class="kt">event</span><span class="w"> </span><span class="nv">VaultToggled</span><span class="p">(</span><span class="kt">bool</span><span class="w"> </span><span class="nv">newState</span><span class="p">);</span><span class="w">                          </span><span class="c1">// 金库状态切换事件</span>
<a href="#__codelineno-14-36" id="__codelineno-14-36" name="__codelineno-14-36"></a>
<a href="#__codelineno-14-37" id="__codelineno-14-37" name="__codelineno-14-37"></a><span class="w">    </span><span class="c1">// ============================================================</span>
<a href="#__codelineno-14-38" id="__codelineno-14-38" name="__codelineno-14-38"></a><span class="w">    </span><span class="c1">//                        修饰符</span>
<a href="#__codelineno-14-39" id="__codelineno-14-39" name="__codelineno-14-39"></a><span class="w">    </span><span class="c1">// require 检查会在字节码中生成 JUMPI 分支，丰富 CFG 图结构</span>
<a href="#__codelineno-14-40" id="__codelineno-14-40" name="__codelineno-14-40"></a><span class="w">    </span><span class="c1">// ============================================================</span>
<a href="#__codelineno-14-41" id="__codelineno-14-41" name="__codelineno-14-41"></a>
<a href="#__codelineno-14-42" id="__codelineno-14-42" name="__codelineno-14-42"></a><span class="w">    </span><span class="c1">/// @notice 仅允许合约所有者调用</span>
<a href="#__codelineno-14-43" id="__codelineno-14-43" name="__codelineno-14-43"></a><span class="w">    </span><span class="kt">modifier</span><span class="w"> </span>onlyOwner<span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-14-44" id="__codelineno-14-44" name="__codelineno-14-44"></a><span class="w">        </span><span class="kt">require</span><span class="p">(</span><span class="k">msg.sender</span><span class="w"> </span><span class="o">==</span><span class="w"> </span>owner<span class="p">,</span><span class="w"> </span><span class="s2">"Unauthorized"</span><span class="p">);</span>
<a href="#__codelineno-14-45" id="__codelineno-14-45" name="__codelineno-14-45"></a><span class="w">        </span>_<span class="p">;</span>
<a href="#__codelineno-14-46" id="__codelineno-14-46" name="__codelineno-14-46"></a><span class="w">    </span><span class="p">}</span>
<a href="#__codelineno-14-47" id="__codelineno-14-47" name="__codelineno-14-47"></a>
<a href="#__codelineno-14-48" id="__codelineno-14-48" name="__codelineno-14-48"></a><span class="w">    </span><span class="c1">/// @notice 仅在金库激活时允许操作</span>
<a href="#__codelineno-14-49" id="__codelineno-14-49" name="__codelineno-14-49"></a><span class="w">    </span><span class="kt">modifier</span><span class="w"> </span>whenActive<span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-14-50" id="__codelineno-14-50" name="__codelineno-14-50"></a><span class="w">        </span><span class="kt">require</span><span class="p">(</span>isActive<span class="p">,</span><span class="w"> </span><span class="s2">"Vault is paused"</span><span class="p">);</span>
<a href="#__codelineno-14-51" id="__codelineno-14-51" name="__codelineno-14-51"></a><span class="w">        </span>_<span class="p">;</span>
<a href="#__codelineno-14-52" id="__codelineno-14-52" name="__codelineno-14-52"></a><span class="w">    </span><span class="p">}</span>
<a href="#__codelineno-14-53" id="__codelineno-14-53" name="__codelineno-14-53"></a>
<a href="#__codelineno-14-54" id="__codelineno-14-54" name="__codelineno-14-54"></a><span class="w">    </span><span class="c1">// ============================================================</span>
<a href="#__codelineno-14-55" id="__codelineno-14-55" name="__codelineno-14-55"></a><span class="w">    </span><span class="c1">//                       构造函数</span>
<a href="#__codelineno-14-56" id="__codelineno-14-56" name="__codelineno-14-56"></a><span class="w">    </span><span class="c1">// 构造函数中初始化状态变量，确保部署后 Storage 中就有非零数据</span>
<a href="#__codelineno-14-57" id="__codelineno-14-57" name="__codelineno-14-57"></a><span class="w">    </span><span class="c1">// 这样即使不做任何交互，heimdall dump 也能导出有意义的内容</span>
<a href="#__codelineno-14-58" id="__codelineno-14-58" name="__codelineno-14-58"></a><span class="w">    </span><span class="c1">// ============================================================</span>
<a href="#__codelineno-14-59" id="__codelineno-14-59" name="__codelineno-14-59"></a>
<a href="#__codelineno-14-60" id="__codelineno-14-60" name="__codelineno-14-60"></a><span class="w">    </span><span class="kt">constructor</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-14-61" id="__codelineno-14-61" name="__codelineno-14-61"></a><span class="w">        </span>owner<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">msg.sender</span><span class="p">;</span><span class="w">     </span><span class="c1">// slot 0: 部署者地址</span>
<a href="#__codelineno-14-62" id="__codelineno-14-62" name="__codelineno-14-62"></a><span class="w">        </span>isActive<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">true</span><span class="p">;</span><span class="w">        </span><span class="c1">// slot 1: 默认激活</span>
<a href="#__codelineno-14-63" id="__codelineno-14-63" name="__codelineno-14-63"></a><span class="w">        </span>totalDeposits<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m m-Decimal">0</span><span class="p">;</span><span class="w">      </span><span class="c1">// slot 2: 初始为 0（显式赋值便于教学理解）</span>
<a href="#__codelineno-14-64" id="__codelineno-14-64" name="__codelineno-14-64"></a><span class="w">    </span><span class="p">}</span>
<a href="#__codelineno-14-65" id="__codelineno-14-65" name="__codelineno-14-65"></a>
<a href="#__codelineno-14-66" id="__codelineno-14-66" name="__codelineno-14-66"></a><span class="w">    </span><span class="cm">/**</span>
<a href="#__codelineno-14-67" id="__codelineno-14-67" name="__codelineno-14-67"></a><span class="cm">     * @notice 存款函数 - 将 ETH 存入金库</span>
<a href="#__codelineno-14-68" id="__codelineno-14-68" name="__codelineno-14-68"></a><span class="cm">     * @dev payable 修饰符允许接收 ETH；Heimdall decompile 会推断出 payable 属性</span>
<a href="#__codelineno-14-69" id="__codelineno-14-69" name="__codelineno-14-69"></a><span class="cm">     *</span>
<a href="#__codelineno-14-70" id="__codelineno-14-70" name="__codelineno-14-70"></a><span class="cm">     * 演示重点：</span>
<a href="#__codelineno-14-71" id="__codelineno-14-71" name="__codelineno-14-71"></a><span class="cm">     *   - Decode: 虽然无参数，但 msg.value 会体现在交易的 value 字段中</span>
<a href="#__codelineno-14-72" id="__codelineno-14-72" name="__codelineno-14-72"></a><span class="cm">     *   - Dump:   调用后 balances mapping 和 totalDeposits 会被更新</span>
<a href="#__codelineno-14-73" id="__codelineno-14-73" name="__codelineno-14-73"></a><span class="cm">     *   - Inspect: 会触发 Deposited 事件，Trace 中可见日志</span>
<a href="#__codelineno-14-74" id="__codelineno-14-74" name="__codelineno-14-74"></a><span class="cm">     */</span>
<a href="#__codelineno-14-75" id="__codelineno-14-75" name="__codelineno-14-75"></a><span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">deposit</span><span class="p">()</span><span class="w"> </span><span class="kt">external</span><span class="w"> </span><span class="kt">payable</span><span class="w"> </span>whenActive<span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-14-76" id="__codelineno-14-76" name="__codelineno-14-76"></a><span class="w">        </span><span class="c1">// 这个分支在 CFG 中会生成一个 JUMPI 节点</span>
<a href="#__codelineno-14-77" id="__codelineno-14-77" name="__codelineno-14-77"></a><span class="w">        </span><span class="kt">require</span><span class="p">(</span><span class="k">msg.value</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m m-Decimal">0</span><span class="p">,</span><span class="w"> </span><span class="s2">"Must send ETH"</span><span class="p">);</span>
<a href="#__codelineno-14-78" id="__codelineno-14-78" name="__codelineno-14-78"></a><span class="w">        </span>balances<span class="p">[</span><span class="k">msg.sender</span><span class="p">]</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="k">msg.value</span><span class="p">;</span>
<a href="#__codelineno-14-79" id="__codelineno-14-79" name="__codelineno-14-79"></a><span class="w">        </span>totalDeposits<span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="k">msg.value</span><span class="p">;</span>
<a href="#__codelineno-14-80" id="__codelineno-14-80" name="__codelineno-14-80"></a><span class="w">        </span>emit<span class="w"> </span>Deposited<span class="p">(</span><span class="k">msg.sender</span><span class="p">,</span><span class="w"> </span><span class="k">msg.value</span><span class="p">);</span>
<a href="#__codelineno-14-81" id="__codelineno-14-81" name="__codelineno-14-81"></a><span class="w">    </span><span class="p">}</span>
<a href="#__codelineno-14-82" id="__codelineno-14-82" name="__codelineno-14-82"></a>
<a href="#__codelineno-14-83" id="__codelineno-14-83" name="__codelineno-14-83"></a><span class="w">    </span><span class="cm">/**</span>
<a href="#__codelineno-14-84" id="__codelineno-14-84" name="__codelineno-14-84"></a><span class="cm">     * @notice 提款函数 - 从金库中取出指定金额的 ETH</span>
<a href="#__codelineno-14-85" id="__codelineno-14-85" name="__codelineno-14-85"></a><span class="cm">     * @param amount 要提取的 ETH 数量（单位：wei）</span>
<a href="#__codelineno-14-86" id="__codelineno-14-86" name="__codelineno-14-86"></a><span class="cm">     *</span>
<a href="#__codelineno-14-87" id="__codelineno-14-87" name="__codelineno-14-87"></a><span class="cm">     * 演示重点（这是演示效果最丰富的函数，建议用它的交易哈希来测试 Decode 和 Inspect）：</span>
<a href="#__codelineno-14-88" id="__codelineno-14-88" name="__codelineno-14-88"></a><span class="cm">     *   - Decode:   参数类型为 uint256，解码后可以看到具体的提款金额</span>
<a href="#__codelineno-14-89" id="__codelineno-14-89" name="__codelineno-14-89"></a><span class="cm">     *   - Inspect:  包含 ETH 转账（CALL 操作）+ 事件日志，Trace 内容最丰富</span>
<a href="#__codelineno-14-90" id="__codelineno-14-90" name="__codelineno-14-90"></a><span class="cm">     *   - CFG:      多个 require 检查形成多层分支结构</span>
<a href="#__codelineno-14-91" id="__codelineno-14-91" name="__codelineno-14-91"></a><span class="cm">     */</span>
<a href="#__codelineno-14-92" id="__codelineno-14-92" name="__codelineno-14-92"></a><span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">withdraw</span><span class="p">(</span><span class="kt">uint256</span><span class="w"> </span><span class="nv">amount</span><span class="p">)</span><span class="w"> </span><span class="kt">external</span><span class="w"> </span>whenActive<span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-14-93" id="__codelineno-14-93" name="__codelineno-14-93"></a><span class="w">        </span><span class="kt">require</span><span class="p">(</span>amount<span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m m-Decimal">0</span><span class="p">,</span><span class="w"> </span><span class="s2">"Amount must be &gt; 0"</span><span class="p">);</span>
<a href="#__codelineno-14-94" id="__codelineno-14-94" name="__codelineno-14-94"></a><span class="w">        </span><span class="kt">require</span><span class="p">(</span>balances<span class="p">[</span><span class="k">msg.sender</span><span class="p">]</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span>amount<span class="p">,</span><span class="w"> </span><span class="s2">"Insufficient balance"</span><span class="p">);</span>
<a href="#__codelineno-14-95" id="__codelineno-14-95" name="__codelineno-14-95"></a>
<a href="#__codelineno-14-96" id="__codelineno-14-96" name="__codelineno-14-96"></a><span class="w">        </span>balances<span class="p">[</span><span class="k">msg.sender</span><span class="p">]</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span>amount<span class="p">;</span>
<a href="#__codelineno-14-97" id="__codelineno-14-97" name="__codelineno-14-97"></a><span class="w">        </span>totalDeposits<span class="w"> </span><span class="o">-=</span><span class="w"> </span>amount<span class="p">;</span>
<a href="#__codelineno-14-98" id="__codelineno-14-98" name="__codelineno-14-98"></a>
<a href="#__codelineno-14-99" id="__codelineno-14-99" name="__codelineno-14-99"></a><span class="w">        </span><span class="c1">// 这一步会在 Trace 中产生一个 CALL 操作，是 Inspect 的核心看点</span>
<a href="#__codelineno-14-100" id="__codelineno-14-100" name="__codelineno-14-100"></a><span class="w">        </span><span class="p">(</span><span class="kt">bool</span><span class="w"> </span><span class="nv">success</span><span class="p">,</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">payable</span><span class="p">(</span><span class="k">msg.sender</span><span class="p">).</span>call<span class="p">{</span>value<span class="o">:</span><span class="w"> </span>amount<span class="p">}(</span><span class="s2">""</span><span class="p">);</span>
<a href="#__codelineno-14-101" id="__codelineno-14-101" name="__codelineno-14-101"></a><span class="w">        </span><span class="kt">require</span><span class="p">(</span>success<span class="p">,</span><span class="w"> </span><span class="s2">"ETH transfer failed"</span><span class="p">);</span>
<a href="#__codelineno-14-102" id="__codelineno-14-102" name="__codelineno-14-102"></a>
<a href="#__codelineno-14-103" id="__codelineno-14-103" name="__codelineno-14-103"></a><span class="w">        </span>emit<span class="w"> </span>Withdrawn<span class="p">(</span><span class="k">msg.sender</span><span class="p">,</span><span class="w"> </span>amount<span class="p">);</span>
<a href="#__codelineno-14-104" id="__codelineno-14-104" name="__codelineno-14-104"></a><span class="w">    </span><span class="p">}</span>
<a href="#__codelineno-14-105" id="__codelineno-14-105" name="__codelineno-14-105"></a>
<a href="#__codelineno-14-106" id="__codelineno-14-106" name="__codelineno-14-106"></a><span class="w">    </span><span class="cm">/**</span>
<a href="#__codelineno-14-107" id="__codelineno-14-107" name="__codelineno-14-107"></a><span class="cm">     * @notice 批量转账函数 - 向多个地址分发金库中的 ETH</span>
<a href="#__codelineno-14-108" id="__codelineno-14-108" name="__codelineno-14-108"></a><span class="cm">     * @param recipients 接收者地址数组</span>
<a href="#__codelineno-14-109" id="__codelineno-14-109" name="__codelineno-14-109"></a><span class="cm">     * @param amounts    对应的转账金额数组</span>
<a href="#__codelineno-14-110" id="__codelineno-14-110" name="__codelineno-14-110"></a><span class="cm">     *</span>
<a href="#__codelineno-14-111" id="__codelineno-14-111" name="__codelineno-14-111"></a><span class="cm">     * 演示重点：</span>
<a href="#__codelineno-14-112" id="__codelineno-14-112" name="__codelineno-14-112"></a><span class="cm">     *   - Decode:   动态数组参数（address[], uint256[]）的 ABI 编码较为复杂，</span>
<a href="#__codelineno-14-113" id="__codelineno-14-113" name="__codelineno-14-113"></a><span class="cm">     *               能充分展示 Heimdall 解码动态类型的能力</span>
<a href="#__codelineno-14-114" id="__codelineno-14-114" name="__codelineno-14-114"></a><span class="cm">     *   - CFG:      for 循环在字节码层面表现为 JUMP 回跳，会在 CFG 中形成环路结构</span>
<a href="#__codelineno-14-115" id="__codelineno-14-115" name="__codelineno-14-115"></a><span class="cm">     *   - Inspect:  多次 CALL + 多次事件触发，Trace 会很丰富</span>
<a href="#__codelineno-14-116" id="__codelineno-14-116" name="__codelineno-14-116"></a><span class="cm">     */</span>
<a href="#__codelineno-14-117" id="__codelineno-14-117" name="__codelineno-14-117"></a><span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">batchTransfer</span><span class="p">(</span>
<a href="#__codelineno-14-118" id="__codelineno-14-118" name="__codelineno-14-118"></a><span class="w">        </span><span class="kt">address</span><span class="p">[]</span><span class="w"> </span>calldata<span class="w"> </span>recipients<span class="p">,</span>
<a href="#__codelineno-14-119" id="__codelineno-14-119" name="__codelineno-14-119"></a><span class="w">        </span><span class="kt">uint256</span><span class="p">[]</span><span class="w"> </span>calldata<span class="w"> </span>amounts
<a href="#__codelineno-14-120" id="__codelineno-14-120" name="__codelineno-14-120"></a><span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="kt">external</span><span class="w"> </span>onlyOwner<span class="w"> </span>whenActive<span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-14-121" id="__codelineno-14-121" name="__codelineno-14-121"></a><span class="w">        </span><span class="kt">require</span><span class="p">(</span>recipients<span class="p">.</span>length<span class="w"> </span><span class="o">==</span><span class="w"> </span>amounts<span class="p">.</span>length<span class="p">,</span><span class="w"> </span><span class="s2">"Length mismatch"</span><span class="p">);</span>
<a href="#__codelineno-14-122" id="__codelineno-14-122" name="__codelineno-14-122"></a><span class="w">        </span><span class="kt">require</span><span class="p">(</span>recipients<span class="p">.</span>length<span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m m-Decimal">0</span><span class="p">,</span><span class="w"> </span><span class="s2">"Empty arrays"</span><span class="p">);</span>
<a href="#__codelineno-14-123" id="__codelineno-14-123" name="__codelineno-14-123"></a>
<a href="#__codelineno-14-124" id="__codelineno-14-124" name="__codelineno-14-124"></a><span class="w">        </span><span class="c1">// 字节码中的循环结构：JUMPDEST → 条件检查 → JUMPI → 循环体 → JUMP 回跳</span>
<a href="#__codelineno-14-125" id="__codelineno-14-125" name="__codelineno-14-125"></a><span class="w">        </span><span class="kt">for</span><span class="w"> </span><span class="p">(</span><span class="kt">uint256</span><span class="w"> </span><span class="nv">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m m-Decimal">0</span><span class="p">;</span><span class="w"> </span>i<span class="w"> </span><span class="o">&lt;</span><span class="w"> </span>recipients<span class="p">.</span>length<span class="p">;</span><span class="w"> </span>i<span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-14-126" id="__codelineno-14-126" name="__codelineno-14-126"></a><span class="w">            </span><span class="kt">require</span><span class="p">(</span>amounts<span class="p">[</span>i<span class="p">]</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m m-Decimal">0</span><span class="p">,</span><span class="w"> </span><span class="s2">"Zero amount"</span><span class="p">);</span>
<a href="#__codelineno-14-127" id="__codelineno-14-127" name="__codelineno-14-127"></a><span class="w">            </span><span class="kt">require</span><span class="p">(</span>recipients<span class="p">[</span>i<span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kt">address</span><span class="p">(</span><span class="m m-Decimal">0</span><span class="p">),</span><span class="w"> </span><span class="s2">"Zero address"</span><span class="p">);</span>
<a href="#__codelineno-14-128" id="__codelineno-14-128" name="__codelineno-14-128"></a>
<a href="#__codelineno-14-129" id="__codelineno-14-129" name="__codelineno-14-129"></a><span class="w">            </span><span class="c1">// 从合约余额中直接转账（不是从 sender 的 balances 中扣）</span>
<a href="#__codelineno-14-130" id="__codelineno-14-130" name="__codelineno-14-130"></a><span class="w">            </span><span class="p">(</span><span class="kt">bool</span><span class="w"> </span><span class="nv">success</span><span class="p">,</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">payable</span><span class="p">(</span>recipients<span class="p">[</span>i<span class="p">]).</span>call<span class="p">{</span>value<span class="o">:</span><span class="w"> </span>amounts<span class="p">[</span>i<span class="p">]}(</span><span class="s2">""</span><span class="p">);</span>
<a href="#__codelineno-14-131" id="__codelineno-14-131" name="__codelineno-14-131"></a><span class="w">            </span><span class="kt">require</span><span class="p">(</span>success<span class="p">,</span><span class="w"> </span><span class="s2">"Transfer failed"</span><span class="p">);</span>
<a href="#__codelineno-14-132" id="__codelineno-14-132" name="__codelineno-14-132"></a><span class="w">        </span><span class="p">}</span>
<a href="#__codelineno-14-133" id="__codelineno-14-133" name="__codelineno-14-133"></a>
<a href="#__codelineno-14-134" id="__codelineno-14-134" name="__codelineno-14-134"></a><span class="w">        </span>emit<span class="w"> </span>BatchTransferred<span class="p">(</span><span class="k">msg.sender</span><span class="p">,</span><span class="w"> </span>recipients<span class="p">.</span>length<span class="p">);</span>
<a href="#__codelineno-14-135" id="__codelineno-14-135" name="__codelineno-14-135"></a><span class="w">    </span><span class="p">}</span>
<a href="#__codelineno-14-136" id="__codelineno-14-136" name="__codelineno-14-136"></a>
<a href="#__codelineno-14-137" id="__codelineno-14-137" name="__codelineno-14-137"></a><span class="w">    </span><span class="c1">// ============================================================</span>
<a href="#__codelineno-14-138" id="__codelineno-14-138" name="__codelineno-14-138"></a><span class="w">    </span><span class="c1">//                       查询函数</span>
<a href="#__codelineno-14-139" id="__codelineno-14-139" name="__codelineno-14-139"></a><span class="w">    </span><span class="c1">// view 函数不修改状态，Heimdall decompile 会推断出 view 属性</span>
<a href="#__codelineno-14-140" id="__codelineno-14-140" name="__codelineno-14-140"></a><span class="w">    </span><span class="c1">// ============================================================</span>
<a href="#__codelineno-14-141" id="__codelineno-14-141" name="__codelineno-14-141"></a>
<a href="#__codelineno-14-142" id="__codelineno-14-142" name="__codelineno-14-142"></a><span class="w">    </span><span class="cm">/**</span>
<a href="#__codelineno-14-143" id="__codelineno-14-143" name="__codelineno-14-143"></a><span class="cm">     * @notice 查询指定地址的存款余额</span>
<a href="#__codelineno-14-144" id="__codelineno-14-144" name="__codelineno-14-144"></a><span class="cm">     * @param user 要查询的地址</span>
<a href="#__codelineno-14-145" id="__codelineno-14-145" name="__codelineno-14-145"></a><span class="cm">     * @return 该地址在金库中的余额（wei）</span>
<a href="#__codelineno-14-146" id="__codelineno-14-146" name="__codelineno-14-146"></a><span class="cm">     * </span>
<a href="#__codelineno-14-147" id="__codelineno-14-147" name="__codelineno-14-147"></a><span class="cm">     * 演示重点：</span>
<a href="#__codelineno-14-148" id="__codelineno-14-148" name="__codelineno-14-148"></a><span class="cm">     *   - Decompile: Heimdall 会推断此函数为 view（因为没有 SSTORE 操作码）</span>
<a href="#__codelineno-14-149" id="__codelineno-14-149" name="__codelineno-14-149"></a><span class="cm">     *   - Decode:    参数类型为 address，解码后可以看到被查询的地址</span>
<a href="#__codelineno-14-150" id="__codelineno-14-150" name="__codelineno-14-150"></a><span class="cm">     */</span>
<a href="#__codelineno-14-151" id="__codelineno-14-151" name="__codelineno-14-151"></a><span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">getBalance</span><span class="p">(</span><span class="kt">address</span><span class="w"> </span><span class="nv">user</span><span class="p">)</span><span class="w"> </span><span class="kt">external</span><span class="w"> </span>view<span class="w"> </span><span class="kt">returns</span><span class="w"> </span><span class="p">(</span><span class="kt">uint256</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-14-152" id="__codelineno-14-152" name="__codelineno-14-152"></a><span class="w">        </span><span class="kt">return</span><span class="w"> </span>balances<span class="p">[</span>user<span class="p">];</span>
<a href="#__codelineno-14-153" id="__codelineno-14-153" name="__codelineno-14-153"></a><span class="w">    </span><span class="p">}</span>
<a href="#__codelineno-14-154" id="__codelineno-14-154" name="__codelineno-14-154"></a>
<a href="#__codelineno-14-155" id="__codelineno-14-155" name="__codelineno-14-155"></a><span class="w">    </span><span class="cm">/**</span>
<a href="#__codelineno-14-156" id="__codelineno-14-156" name="__codelineno-14-156"></a><span class="cm">     * @notice 查询合约自身持有的 ETH 总量</span>
<a href="#__codelineno-14-157" id="__codelineno-14-157" name="__codelineno-14-157"></a><span class="cm">     * @return 合约地址的 ETH 余额（wei）</span>
<a href="#__codelineno-14-158" id="__codelineno-14-158" name="__codelineno-14-158"></a><span class="cm">     * </span>
<a href="#__codelineno-14-159" id="__codelineno-14-159" name="__codelineno-14-159"></a><span class="cm">     * 演示重点：</span>
<a href="#__codelineno-14-160" id="__codelineno-14-160" name="__codelineno-14-160"></a><span class="cm">     *   - Decompile: 使用了 address(this).balance，反编译后可以看到 SELFBALANCE 操作码的还原</span>
<a href="#__codelineno-14-161" id="__codelineno-14-161" name="__codelineno-14-161"></a><span class="cm">     */</span>
<a href="#__codelineno-14-162" id="__codelineno-14-162" name="__codelineno-14-162"></a><span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">getVaultBalance</span><span class="p">()</span><span class="w"> </span><span class="kt">external</span><span class="w"> </span>view<span class="w"> </span><span class="kt">returns</span><span class="w"> </span><span class="p">(</span><span class="kt">uint256</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-14-163" id="__codelineno-14-163" name="__codelineno-14-163"></a><span class="w">        </span><span class="kt">return</span><span class="w"> </span><span class="kt">address</span><span class="p">(</span><span class="kt">this</span><span class="p">).</span>balance<span class="p">;</span>
<a href="#__codelineno-14-164" id="__codelineno-14-164" name="__codelineno-14-164"></a><span class="w">    </span><span class="p">}</span>
<a href="#__codelineno-14-165" id="__codelineno-14-165" name="__codelineno-14-165"></a>
<a href="#__codelineno-14-166" id="__codelineno-14-166" name="__codelineno-14-166"></a><span class="w">    </span><span class="c1">// ============================================================</span>
<a href="#__codelineno-14-167" id="__codelineno-14-167" name="__codelineno-14-167"></a><span class="w">    </span><span class="c1">//                       管理函数</span>
<a href="#__codelineno-14-168" id="__codelineno-14-168" name="__codelineno-14-168"></a><span class="w">    </span><span class="c1">// ============================================================</span>
<a href="#__codelineno-14-169" id="__codelineno-14-169" name="__codelineno-14-169"></a>
<a href="#__codelineno-14-170" id="__codelineno-14-170" name="__codelineno-14-170"></a><span class="w">    </span><span class="cm">/**</span>
<a href="#__codelineno-14-171" id="__codelineno-14-171" name="__codelineno-14-171"></a><span class="cm">     * @notice 切换金库的激活/暂停状态</span>
<a href="#__codelineno-14-172" id="__codelineno-14-172" name="__codelineno-14-172"></a><span class="cm">     *</span>
<a href="#__codelineno-14-173" id="__codelineno-14-173" name="__codelineno-14-173"></a><span class="cm">     * 演示重点：</span>
<a href="#__codelineno-14-174" id="__codelineno-14-174" name="__codelineno-14-174"></a><span class="cm">     *   - CFG:       简单的状态翻转逻辑，在 CFG 中是一个清晰的线性路径</span>
<a href="#__codelineno-14-175" id="__codelineno-14-175" name="__codelineno-14-175"></a><span class="cm">     *   - Dump:      调用后 isActive (slot 1) 的值会从 true 变为 false 或反之</span>
<a href="#__codelineno-14-176" id="__codelineno-14-176" name="__codelineno-14-176"></a><span class="cm">     *   - Decompile: onlyOwner 修饰符的 require 检查会被还原</span>
<a href="#__codelineno-14-177" id="__codelineno-14-177" name="__codelineno-14-177"></a><span class="cm">     */</span>
<a href="#__codelineno-14-178" id="__codelineno-14-178" name="__codelineno-14-178"></a><span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">toggleActive</span><span class="p">()</span><span class="w"> </span><span class="kt">external</span><span class="w"> </span>onlyOwner<span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-14-179" id="__codelineno-14-179" name="__codelineno-14-179"></a><span class="w">        </span>isActive<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">!</span>isActive<span class="p">;</span>
<a href="#__codelineno-14-180" id="__codelineno-14-180" name="__codelineno-14-180"></a><span class="w">        </span>emit<span class="w"> </span>VaultToggled<span class="p">(</span>isActive<span class="p">);</span>
<a href="#__codelineno-14-181" id="__codelineno-14-181" name="__codelineno-14-181"></a><span class="w">    </span><span class="p">}</span>
<a href="#__codelineno-14-182" id="__codelineno-14-182" name="__codelineno-14-182"></a>
<a href="#__codelineno-14-183" id="__codelineno-14-183" name="__codelineno-14-183"></a><span class="w">    </span><span class="cm">/**</span>
<a href="#__codelineno-14-184" id="__codelineno-14-184" name="__codelineno-14-184"></a><span class="cm">     * @notice 允许合约接收 ETH（不通过 deposit 函数直接转账时触发）</span>
<a href="#__codelineno-14-185" id="__codelineno-14-185" name="__codelineno-14-185"></a><span class="cm">     * @dev receive 函数在字节码中会生成独立的分发路径，</span>
<a href="#__codelineno-14-186" id="__codelineno-14-186" name="__codelineno-14-186"></a><span class="cm">     *      CFG 中可以看到 calldata size == 0 时的跳转分支</span>
<a href="#__codelineno-14-187" id="__codelineno-14-187" name="__codelineno-14-187"></a><span class="cm">     */</span>
<a href="#__codelineno-14-188" id="__codelineno-14-188" name="__codelineno-14-188"></a><span class="w">    </span>receive<span class="p">()</span><span class="w"> </span><span class="kt">external</span><span class="w"> </span><span class="kt">payable</span><span class="w"> </span><span class="p">{</span>
<a href="#__codelineno-14-189" id="__codelineno-14-189" name="__codelineno-14-189"></a><span class="w">        </span>balances<span class="p">[</span><span class="k">msg.sender</span><span class="p">]</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="k">msg.value</span><span class="p">;</span><span class="w">  </span><span class="c1">// 直接转入的 ETH 也计入发送者的余额</span>
<a href="#__codelineno-14-190" id="__codelineno-14-190" name="__codelineno-14-190"></a><span class="w">        </span>totalDeposits<span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="k">msg.value</span><span class="p">;</span>
<a href="#__codelineno-14-191" id="__codelineno-14-191" name="__codelineno-14-191"></a><span class="w">        </span>emit<span class="w"> </span>Deposited<span class="p">(</span><span class="k">msg.sender</span><span class="p">,</span><span class="w"> </span><span class="k">msg.value</span><span class="p">);</span>
<a href="#__codelineno-14-192" id="__codelineno-14-192" name="__codelineno-14-192"></a><span class="w">    </span><span class="p">}</span>
<a href="#__codelineno-14-193" id="__codelineno-14-193" name="__codelineno-14-193"></a><span class="p">}</span>
</code></pre></div>
</details>
<p><strong>部署信息：</strong></p>
<ul>
<li>网络：Sepolia Testnet（Chain ID: 11155111）</li>
<li>合约地址：<code>0x411885324AFd60404252213106C006E6Fff84C79</code></li>
<li>免费公共<span><span class="heti-spacing"> </span>RPC</span>：<code>https://ethereum-sepolia-rpc.publicnode.com</code></li>
</ul>
<blockquote>
<p>💡 本次分析使用<span class="heti-skip"><span class="heti-spacing"> </span>Claude Code<span class="heti-spacing"> </span></span>通过<span><span class="heti-spacing"> </span>MCP</span>（Model Context Protocol）集成<span><span class="heti-spacing"> </span>Heimdall-rs</span>，<span>AI Agent<span class="heti-spacing"> </span></span>并非简单地搜索或转述信息，而是通过 <code>foundry_mcp_server</code> <strong>实时调用</strong> <span>Heimdall<span class="heti-spacing"> </span></span>的各个子命令，读取生成的反编译文件和控制流图，再对输出结果进行逻辑推演和交叉验证。整个模块分析流程由一条<span class="heti-skip"><span class="heti-spacing"> </span>Prompt<span class="heti-spacing"> </span></span>指令驱动。完整的<span class="heti-skip"><span class="heti-spacing"> </span>Prompt<span class="heti-spacing"> </span></span>模板和生成的所有分析文件见 附录。</p>
</blockquote>
<h3 id="decompile">分析结果一：反编译（Decompile）— 还原函数接口<a class="headerlink" href="#decompile" title="Permanent link"><span><span class="heti-spacing"> </span>¶</span></a></h3>
<p><span>Heimdall<span class="heti-spacing"> </span></span>在完全没有<span class="heti-skip"><span class="heti-spacing"> </span>ABI<span class="heti-spacing"> </span></span>的情况下，从纯字节码中成功还原出了合约的全部<span class="heti-skip"><span class="heti-spacing"> </span>10<span class="heti-spacing"> </span></span>个函数签名。下表是反编译输出的函数接口汇总：</p>
<table>
<thead>
<tr>
<th>函数</th>
<th>选择器</th>
<th>功能说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>owner()</code></td>
<td>—</td>
<td>查询合约所有者</td>
</tr>
<tr>
<td><code>isActive()</code></td>
<td>—</td>
<td>查询金库是否处于激活状态</td>
</tr>
<tr>
<td><code>totalDeposits()</code></td>
<td>—</td>
<td>查询总存款量</td>
</tr>
<tr>
<td><code>deposit()</code></td>
<td><code>0xd0e30db0</code></td>
<td>存入<span><span class="heti-spacing"> </span>ETH</span></td>
</tr>
<tr>
<td><code>withdraw(uint256)</code></td>
<td><code>0x2e1a7d4d</code></td>
<td>提取指定数量的<span><span class="heti-spacing"> </span>ETH</span></td>
</tr>
<tr>
<td><code>getBalance(address)</code></td>
<td><code>0xf8b2cb4f</code></td>
<td>查询某地址的存款余额</td>
</tr>
<tr>
<td><code>balances(address)</code></td>
<td><code>0x27e235e3</code></td>
<td>查询余额映射</td>
</tr>
<tr>
<td><code>getVaultBalance()</code></td>
<td><code>0xed12e8ef</code></td>
<td>查询合约持有的<span class="heti-skip"><span class="heti-spacing"> </span>ETH<span class="heti-spacing"> </span></span>总量</td>
</tr>
<tr>
<td><code>toggleActive()</code></td>
<td><code>0x29c68dc1</code></td>
<td>切换金库激活<span class="heti-skip"><span class="heti-spacing"> </span>/<span class="heti-spacing"> </span></span>暂停状态（仅<span><span class="heti-spacing"> </span>owner</span>）</td>
</tr>
<tr>
<td><code>batchTransfer(address[],uint256[])</code></td>
<td><code>0x88d695b2</code></td>
<td>批量转账（仅<span><span class="heti-spacing"> </span>owner</span>）</td>
</tr>
</tbody>
</table>
<p>反编译同时还原出了两个事件：<code>BatchTransferred(address, uint256)</code> 在批量转账完成时触发，另一个匿名事件 <code>Event_381234db()</code> 在 <code>toggleActive</code> 切换状态时触发。值得注意的是，后者在原始源码中是 <code>VaultToggled(bool newState)</code>，<span>Heimdall<span class="heti-spacing"> </span></span>无法从字节码中完整还原事件名称（因为事件名在编译后只保留<span class="heti-skip"><span class="heti-spacing"> </span>keccak256<span class="heti-spacing"> </span></span>哈希值<heti-adjacent class="heti-adjacent-half">）</heti-adjacent>，但它正确识别了事件的触发位置和参数结构。</p>
<p>反编译还准确还原了合约的核心业务逻辑。以 <code>deposit()</code> 为例，还原出的伪代码包含了完整的检查链：先验证金库处于激活状态（<code>require(isActive == true)</code><heti-adjacent class="heti-adjacent-half">）</heti-adjacent>，再检查 <code>msg.value &gt; 0</code>，然后执行 <code>balances[msg.sender] += msg.value</code> 和 <code>totalDeposits += msg.value</code>，溢出保护也被正确识别。这与原始<span class="heti-skip"><span class="heti-spacing"> </span>Solidity<span class="heti-spacing"> </span></span>源码几乎完全一致。</p>
<h3 id="disassemble">分析结果二：反汇编（Disassemble）— 操作码安全扫描<a class="headerlink" href="#disassemble" title="Permanent link"><span><span class="heti-spacing"> </span>¶</span></a></h3>
<p>反汇编输出了完整的<span class="heti-skip"><span class="heti-spacing"> </span>EVM<span class="heti-spacing"> </span></span>操作码序列。在安全审计场景中，我们最关心的是是否存在高风险操作码。以下是关键操作码的统计结果：</p>
<table>
<thead>
<tr>
<th>操作码</th>
<th>出现次数</th>
<th>安全意义</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>CALL</code></td>
<td><span>2<span class="heti-spacing"> </span></span>次</td>
<td><code>withdraw</code> 和 <code>batchTransfer</code> 各一处<span class="heti-skip"><span class="heti-spacing"> </span>ETH<span class="heti-spacing"> </span></span>转账，属于正常业务逻辑</td>
</tr>
<tr>
<td><code>SSTORE</code></td>
<td><span>7<span class="heti-spacing"> </span></span>次</td>
<td>状态写入（余额更新、totalDeposits、<span>isActive<span class="heti-spacing"> </span></span>等）</td>
</tr>
<tr>
<td><code>LOG2</code> / <code>LOG1</code></td>
<td><span>5 / 1<span class="heti-spacing"> </span></span>次</td>
<td>事件记录，无安全风险</td>
</tr>
<tr>
<td><code>DELEGATECALL</code></td>
<td><strong><span>0<span class="heti-spacing"> </span></span>次</strong></td>
<td>✅ 不存在代理模式的逻辑篡改风险</td>
</tr>
<tr>
<td><code>SELFDESTRUCT</code></td>
<td><strong><span>0<span class="heti-spacing"> </span></span>次</strong></td>
<td>✅ 合约不可被销毁</td>
</tr>
<tr>
<td><code>CALLCODE</code></td>
<td><strong><span>0<span class="heti-spacing"> </span></span>次</strong></td>
<td>✅ 不存在已废弃的危险调用方式</td>
</tr>
<tr>
<td><code>CREATE</code></td>
<td><span>1<span class="heti-spacing"> </span></span>次</td>
<td>出现在合约末尾，属于构造函数的部署码部分，非运行时风险</td>
</tr>
</tbody>
</table>
<p>这份操作码扫描的价值在于：在没有源码的情况下，你可以在几秒钟内确认一个合约是否包含 <code>DELEGATECALL</code>（代理合约风险<heti-adjacent class="heti-adjacent-half">）</heti-adjacent><heti-adjacent class="heti-adjacent-half">、</heti-adjacent><code>SELFDESTRUCT</code>（合约可被销毁）或 <code>CALLCODE</code>（已废弃的危险调用）等高风险指令，快速建立对合约安全性的初步判断。</p>
<h3 id="cfg">分析结果三：控制流图（CFG）— 可视化逻辑结构<a class="headerlink" href="#cfg" title="Permanent link"><span><span class="heti-spacing"> </span>¶</span></a></h3>
<p><span>Heimdall<span class="heti-spacing"> </span></span>生成的控制流图（<code>.dot</code> 格式）清晰展示了合约的执行路径：</p>
<ul>
<li><strong>入口节点</strong>：首先检查 <code>CALLVALUE != 0</code>，如果携带<span class="heti-skip"><span class="heti-spacing"> </span>ETH<span class="heti-spacing"> </span></span>但调用的不是<span class="heti-skip"><span class="heti-spacing"> </span>payable<span class="heti-spacing"> </span></span>函数则直接<span><span class="heti-spacing"> </span>REVERT</span></li>
<li><strong>路由节点</strong>：检查 <code>CALLDATASIZE &gt;= 4</code> 后读取函数选择器，通过一系列比较跳转到对应的函数实现</li>
<li><strong>函数内部</strong>：每个函数都有多重 <code>require</code> 检查形成级联的条件分支，而 <code>batchTransfer</code> 中的 <code>for</code> 循环在<span class="heti-skip"><span class="heti-spacing"> </span>CFG<span class="heti-spacing"> </span></span>中表现为明显的回跳环路结构</li>
</ul>
<p><span>CFG<span class="heti-spacing"> </span></span>对安全审计的价值在于图形化呈现——你可以一眼看出是否存在异常的跳转路径或隐藏的后门分支，而不需要逐行阅读操作码。</p>
<h3 id="dump">分析结果四：存储导出（Dump）— 读取链上状态<a class="headerlink" href="#dump" title="Permanent link"><span><span class="heti-spacing"> </span>¶</span></a></h3>
<p>通过 <code>dump</code> 配合 <code>cast</code>（<span>Foundry<span class="heti-spacing"> </span></span>工具）读取存储槽，还原出了合约的完整存储布局和当前状态：</p>
<table>
<thead>
<tr>
<th>存储槽</th>
<th>变量</th>
<th>当前值</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td>Slot 0</td>
<td><code>owner</code> + <code>isActive</code></td>
<td><code>0x1d477b...7AA0</code> / <code>true</code></td>
<td><span>owner<span class="heti-spacing"> </span></span>和<span><span class="heti-spacing"> </span>isActive</span> <strong>打包在同一个<span><span class="heti-spacing"> </span>slot</span></strong> 中</td>
</tr>
<tr>
<td>Slot 1</td>
<td><code>totalDeposits</code></td>
<td>0.03597 ETH</td>
<td>历史累计存入总额</td>
</tr>
<tr>
<td>Slot 2</td>
<td><code>balances</code></td>
<td>mapping</td>
<td>每个用户的存款余额映射</td>
</tr>
</tbody>
</table>
<p>这里有一个值得关注的细节<heti-adjacent class="heti-adjacent-half">：</heti-adjacent><code>owner</code>（<span>address<span class="heti-spacing"> </span></span>类型，占<span class="heti-skip"><span class="heti-spacing"> </span>20<span class="heti-spacing"> </span></span>字节）和 <code>isActive</code>（<span>bool<span class="heti-spacing"> </span></span>类型，占<span class="heti-skip"><span class="heti-spacing"> </span>1<span class="heti-spacing"> </span></span>字节）被<span class="heti-skip"><span class="heti-spacing"> </span>Solidity<span class="heti-spacing"> </span></span>编译器<strong>打包到同一个<span class="heti-skip"><span class="heti-spacing"> </span>32<span class="heti-spacing"> </span></span>字节的存储槽</strong>中，这是<span class="heti-skip"><span class="heti-spacing"> </span>Solidity<span class="heti-spacing"> </span></span>的紧凑存储优化（Storage Packing<heti-adjacent class="heti-adjacent-half">）</heti-adjacent>。通过 <code>cast storage</code> 读取<span class="heti-skip"><span class="heti-spacing"> </span>Slot 0<span class="heti-spacing"> </span></span>的原始数据，你会看到一串<span class="heti-skip"><span class="heti-spacing"> </span>32<span class="heti-spacing"> </span></span>字节的<span class="heti-skip"><span class="heti-spacing"> </span>Hex<span class="heti-spacing"> </span></span>值：</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-15-1" id="__codelineno-15-1" name="__codelineno-15-1"></a>0x0000000000000000000000011d477b7733fe1347ee91e8d15f8c7f203e147aa0
</code></pre></div>
<p><span>Heimdall<span class="heti-spacing"> </span></span>正确地将这串数据拆解为两个独立变量：低<span class="heti-skip"><span class="heti-spacing"> </span>160<span class="heti-spacing"> </span></span>位（<span>20<span class="heti-spacing"> </span></span>字节）是 <code>owner</code> 地址 <code>0x1d477b...7AA0</code>，紧邻其上的<span class="heti-skip"><span class="heti-spacing"> </span>1<span class="heti-spacing"> </span></span>字节 <code>01</code> 则是 <code>isActive = true</code>。在源码中，这两个变量分别声明为 <code>address public owner</code> 和 <code>bool public isActive</code>，<span>Solidity<span class="heti-spacing"> </span></span>编译器发现它们的总大小（<span>20 + 1 = 21<span class="heti-spacing"> </span></span>字节）不超过<span class="heti-skip"><span class="heti-spacing"> </span>32<span class="heti-spacing"> </span></span>字节，于是自动将它们打包进同一个<span class="heti-skip"><span class="heti-spacing"> </span>slot<span class="heti-spacing"> </span></span>以节省<span><span class="heti-spacing"> </span>gas</span>。能从纯字节码中正确还原这种打包行为，体现了<span class="heti-skip"><span class="heti-spacing"> </span>Heimdall<span class="heti-spacing"> </span></span>反编译引擎对<span class="heti-skip"><span class="heti-spacing"> </span>EVM<span class="heti-spacing"> </span></span>存储模型的深度理解。</p>
<p>另一个有趣的发现是数据不一致：<code>totalDeposits</code> 显示累计存款为<span><span class="heti-spacing"> </span>0.03597 ETH</span>，但通过 <code>getVaultBalance()</code> 查询合约实际余额只有<span><span class="heti-spacing"> </span>0.006 ETH</span>，差额约<span><span class="heti-spacing"> </span>0.03 ETH</span>。这说明已有资金被提走或转出——在真实审计场景中，这种差异往往是进一步调查的起点。</p>
<h3 id="decode-batchtransfer">分析结果五：交易解码（Decode）— 解析<span class="heti-skip"><span class="heti-spacing"> </span>batchTransfer<span class="heti-spacing"> </span></span>调用<a class="headerlink" href="#decode-batchtransfer" title="Permanent link"><span><span class="heti-spacing"> </span>¶</span></a></h3>
<p>使用 <code>decode</code> 解析交易 <code>0x63bd2f2e...</code> 的<span><span class="heti-spacing"> </span>Calldata</span>，<span>Heimdall<span class="heti-spacing"> </span></span>成功还原了完整的函数调用信息：</p>
<ul>
<li><strong>函数</strong>：<code>batchTransfer(address[], uint256[])</code></li>
<li><strong>参数<span><span class="heti-spacing"> </span>addresses</span></strong>：[<code>0x1d477b...</code>（<span>owner<span class="heti-spacing"> </span></span>本人）, <code>0x84B62e...</code>]</li>
<li><strong>参数<span><span class="heti-spacing"> </span>amounts</span></strong>：[0.02 ETH, 0.01 ETH]</li>
</ul>
<p>将解码结果与反编译代码进行对比验证：该交易由<span class="heti-skip"><span class="heti-spacing"> </span>owner<span class="heti-spacing"> </span></span>发起（通过 <code>require(msg.sender == owner)</code> 检查<heti-adjacent class="heti-adjacent-half">）</heti-adjacent>、金库处于激活状态（通过 <code>require(isActive)</code> 检查<heti-adjacent class="heti-adjacent-half">）</heti-adjacent>、两个数组长度一致（通过长度匹配检查<heti-adjacent class="heti-adjacent-half">）</heti-adjacent>、地址均非零且金额均大于<span><span class="heti-spacing"> </span>0</span>（通过循环内检查<heti-adjacent class="heti-adjacent-half">）</heti-adjacent>。所有条件均满足，交易成功执行并触发了 <code>BatchTransferred(owner, 2)</code> 事件。</p>
<p>这个例子很好地展示了 <code>decode</code> 的价值：面对一串不可读的十六进制<span><span class="heti-spacing"> </span>Calldata</span>，<span>Heimdall<span class="heti-spacing"> </span></span>无需<span class="heti-skip"><span class="heti-spacing"> </span>ABI<span class="heti-spacing"> </span></span>就能解析出完整的函数名和参数——对于动态数组这类复杂的<span class="heti-skip"><span class="heti-spacing"> </span>ABI<span class="heti-spacing"> </span></span>编码格式尤其有用。</p>
<h3 id="inspect-withdraw">分析结果六：交易检查（Inspect）— 追踪<span class="heti-skip"><span class="heti-spacing"> </span>withdraw<span class="heti-spacing"> </span></span>内部调用<a class="headerlink" href="#inspect-withdraw" title="Permanent link"><span><span class="heti-spacing"> </span>¶</span></a></h3>
<p>使用 <code>inspect</code> 追踪交易 <code>0xa66c471b...</code>，还原了一笔 <code>withdraw(0.004 ETH)</code> 的完整执行过程：</p>
<ul>
<li>发送者 <code>0x1d477b...</code>（owner）调用 <code>withdraw(4000000000000000)</code></li>
<li>合约先执行 <code>SSTORE</code> 更新 <code>balances</code> 映射（减少<span><span class="heti-spacing"> </span>0.004 ETH</span>）</li>
<li>然后执行 <code>CALL</code> 向调用者发送<span><span class="heti-spacing"> </span>0.004 ETH</span></li>
<li>最后触发<span class="heti-skip"><span class="heti-spacing"> </span>Withdrawal<span class="heti-spacing"> </span></span>事件，<span>LOG2<span class="heti-spacing"> </span></span>日志中记录了提款者地址和金额</li>
</ul>
<p><code>inspect</code> 的核心价值在于<strong>可视化内部调用流</strong>。在这笔交易中，我们可以清楚地看到合约采用了 <strong>Checks-Effects-Interactions（CEI）模式</strong>——先更新状态（SSTORE<heti-adjacent class="heti-adjacent-half">）</heti-adjacent>，再执行外部调用（CALL<heti-adjacent class="heti-adjacent-half">）</heti-adjacent>。这一顺序对防范重入攻击至关重要，而通过 <code>inspect</code> 可以在不读源码的情况下直接从交易<span class="heti-skip"><span class="heti-spacing"> </span>Trace<span class="heti-spacing"> </span></span>中确认这一点。</p>
<h3 id="_5">安全发现总结<a class="headerlink" href="#_5" title="Permanent link"><span><span class="heti-spacing"> </span>¶</span></a></h3>
<p>综合六个模块的分析结果，可以对这个未开源合约形成完整的安全评估：</p>
<p><strong>合理的安全设计：</strong> 合约不含<code>DELEGATECALL</code><span class="heti-skip"><span class="heti-spacing"> </span>/<span class="heti-spacing"> </span></span><code>SELFDESTRUCT</code><span class="heti-skip"><span class="heti-spacing"> </span>/<span class="heti-spacing"> </span></span><code>CALLCODE</code>等高风险操作码；<code>withdraw</code> 函数遵循<span class="heti-skip"><span class="heti-spacing"> </span>CEI<span class="heti-spacing"> </span></span>模式，降低了重入风险；<code>toggleActive</code> 和 <code>batchTransfer</code> 均有<span class="heti-skip"><span class="heti-spacing"> </span>owner<span class="heti-spacing"> </span></span>权限校验；<code>deposit</code> 中对余额累加进行了溢出保护。</p>
<blockquote>
<p><strong>⚠️ 高危发现：<code>batchTransfer</code> 存在资金挪用风险</strong></p>
<p>从反编译代码中可以看出，<code>batchTransfer</code> 直接从合约余额中转出<span><span class="heti-spacing"> </span>ETH</span>，<strong>没有对应减少任何用户的<code>balances</code><span><span class="heti-spacing"> </span>mapping</span></strong>。这意味着<span class="heti-skip"><span class="heti-spacing"> </span>owner<span class="heti-spacing"> </span></span>可以绕过用户余额限制，将金库中<strong>所有用户</strong>的存款全部转走，而链上的 <code>balances</code> 记录不会反映这笔支出。</p>
<p>更进一步，<span>owner<span class="heti-spacing"> </span></span>还可以通过 <code>toggleActive()</code> 暂停金库，阻止所有用户提款，然后再通过 <code>batchTransfer</code> 将剩余资金全部转出——这构成了一个完整的<span class="heti-skip"><span class="heti-spacing"> </span>Rug Pull<span class="heti-spacing"> </span></span>路径。整个过程中，没有多签、时间锁或治理机制能够阻止这一操作。<strong>这是此合约最大的安全隐患。</strong></p>
</blockquote>
<p>这个发现完全来自对字节码的逆向分析，体现了<span class="heti-skip"><span class="heti-spacing"> </span>Heimdall-rs<span class="heti-spacing"> </span></span>在实战安全审计中的核心价值：即使面对完全未开源的合约，你也能通过反编译和交易验证发现潜在的设计缺陷。</p>
<h2 id="_6">使用场景<a class="headerlink" href="#_6" title="Permanent link"><span><span class="heti-spacing"> </span>¶</span></a></h2>
<p><strong>安全审计：</strong> 在没有源码的情况下，通过反编译和<span class="heti-skip"><span class="heti-spacing"> </span>CFG<span class="heti-spacing"> </span></span>检查第三方协议的安全性。这在评估新<span class="heti-skip"><span class="heti-spacing"> </span>DeFi<span class="heti-spacing"> </span></span>协议的风险时尤为有用。</p>
<p><strong>攻击分析：</strong> 当链上发生安全事故时，可以快速反编译攻击合约、解码攻击交易的<span><span class="heti-spacing"> </span>Calldata</span>，理解黑客的完整攻击路径。</p>
<p><strong>逆向工程：</strong> 探索闭源项目（如<span class="heti-skip"><span class="heti-spacing"> </span>MEV<span class="heti-spacing"> </span></span>机器人的策略合约）的实现逻辑。</p>
<p><strong>漏洞赏金：</strong> 在<span class="heti-skip"><span class="heti-spacing"> </span>Bug Bounty<span class="heti-spacing"> </span></span>项目中，对那些未公开源码的合约进行深度分析，寻找潜在漏洞。</p>
<h2 id="_7">技术优势<a class="headerlink" href="#_7" title="Permanent link"><span><span class="heti-spacing"> </span>¶</span></a></h2>
<p><strong><span>Rust<span class="heti-spacing"> </span></span>驱动的极速性能：</strong> 在处理复杂的递归分析和大规模字节码时，速度远超<span class="heti-skip"><span class="heti-spacing"> </span>Python<span class="heti-spacing"> </span></span>或<span class="heti-skip"><span class="heti-spacing"> </span>JavaScript<span class="heti-spacing"> </span></span>编写的同类工具（如<span><span class="heti-spacing"> </span>Panoramix</span><heti-adjacent class="heti-adjacent-half">）</heti-adjacent>。</p>
<p><strong>符号执行与启发式算法：</strong> 结合符号执行和先进的启发式算法来推断函数名称和逻辑，即使在没有<span class="heti-skip"><span class="heti-spacing"> </span>ABI<span class="heti-spacing"> </span></span>的情况下也能高度还原合约意图。</p>
<p><strong>灵活的输入方式：</strong> 支持直接从以太坊节点（通过<span><span class="heti-spacing"> </span>RPC URL</span>）拉取合约代码，也支持本地字节码文件或原始十六进制输入。此外支持<span class="heti-skip"><span class="heti-spacing"> </span>MESC<span class="heti-spacing"> </span></span>标准进行<span class="heti-skip"><span class="heti-spacing"> </span>RPC<span class="heti-spacing"> </span></span>端点统一配置。</p>
<p><strong>学术认可：</strong> <span>Heimdall-rs<span class="heti-spacing"> </span></span>已被多篇学术论文和硕士论文引用，在智能合约分析领域具有广泛的学术影响力。</p>
<h2 id="_8">附录<a class="headerlink" href="#_8" title="Permanent link"><span><span class="heti-spacing"> </span>¶</span></a></h2>
<h3 id="a-ai-agent-prompt"><span>A. AI Agent<span class="heti-spacing"> </span></span>分析<span class="heti-skip"><span class="heti-spacing"> </span>Prompt<span class="heti-spacing"> </span></span>模板<a class="headerlink" href="#a-ai-agent-prompt" title="Permanent link"><span><span class="heti-spacing"> </span>¶</span></a></h3>
<p>以下是本次实战演示中使用的完整<span><span class="heti-spacing"> </span>Prompt</span>，通过<span class="heti-skip"><span class="heti-spacing"> </span>MCP<span class="heti-spacing"> </span></span>协议集成<span class="heti-skip"><span class="heti-spacing"> </span>Foundry MCP Server<span class="heti-spacing"> </span></span>的<span class="heti-skip"><span class="heti-spacing"> </span>Heimdall-rs<span class="heti-spacing"> </span></span>工具集，让<span class="heti-skip"><span class="heti-spacing"> </span>AI Agent<span class="heti-spacing"> </span></span>自动化执行全部六个分析模块并生成结构化报告。你可以根据自己的目标合约和<span class="heti-skip"><span class="heti-spacing"> </span>RPC<span class="heti-spacing"> </span></span>地址进行修改后直接使用：</p>
<blockquote>
<p>我需要对<span class="heti-skip"><span class="heti-spacing"> </span>Sepolia<span class="heti-spacing"> </span></span>上的未验证合约 <code>0x411885324afd60404252213106c006e6fff84c79</code> 进行深度逆向分析。请使用 <code>foundry_mcp_server</code> 提供的 <strong>Heimdall-rs</strong> 工具集，按以下步骤执行并汇总报告：</p>
<p><strong><span>1.<span class="heti-spacing"> </span></span>静态结构分析：</strong> 执行 <code>decompile</code> 还原逻辑，并生成 <code>cfg</code> 控制流图（请描述图中的主要逻辑分支<heti-adjacent class="heti-adjacent-half">）</heti-adjacent>。</p>
<p><strong><span>2.<span class="heti-spacing"> </span></span>底层指令查看：</strong> 执行 <code>disassemble</code> 观察关键的操作码分布，特别关注是否存在 <code>delegatecall</code> 或 <code>selfdestruct</code> 等敏感指令。</p>
<p><strong><span>3.<span class="heti-spacing"> </span></span>存储布局导出：</strong> 执行 <code>dump</code> 导出当前的存储槽，重点分析<span class="heti-skip"><span class="heti-spacing"> </span>Slot 0 (<span class="heti-spacing"> </span></span><code>owner</code><span class="heti-skip"><span class="heti-spacing"> </span>)<span class="heti-spacing"> </span></span>和<span class="heti-skip"><span class="heti-spacing"> </span>Slot 1 (<span class="heti-spacing"> </span></span><code>isActive</code><span class="heti-skip"><span class="heti-spacing"> </span>)<span class="heti-spacing"> </span></span>的当前值及其含义。</p>
<p><strong><span>4.<span class="heti-spacing"> </span></span>交易行为解码：</strong></p>
<ul>
<li>使用 <code>decode</code> 解析这笔交易的输入参数：<code>0x63bd2f2e19ad89eeeac17fba2a49b28a63aaf0e8b09e369a645699212d256073</code>，请说明这笔交易调用了哪个函数，传入了什么参数。</li>
<li>使用 <code>inspect</code> 追踪这笔提款交易的内部调用流：<code>0xa66c471b820f80f8ec60424d88a6b7145a0aef4fd8e0db31ea996ed652efbbe1</code>，请详细解释其中的内部调用流。</li>
</ul>
<p>请将 <code>decode</code> 得到的参数与 <code>decompile</code> 还原出的逻辑进行对比，确认该笔交易是否触发了代码中的预期分支，并解释 <code>inspect</code> 追踪到的内部调用与代码逻辑是否一致。</p>
<p>请在分析完成后，用中文提交一份结构清晰的报告，涵盖：核心业务逻辑、是否存在潜在风险，以及你对各模块分析结果的解读。</p>
<p><span>RPC URL<span class="heti-spacing"> </span></span>请使用：<code>https://eth-sepolia.g.alchemy.com/v2/&lt;YOUR_API_KEY&gt;</code></p>
<p><strong>注意：</strong> 如果生成了反编译的源文件或控制流图文件，请务必读取文件内容并结合代码进行深度解读，不要只报告<span class="heti-skip"><span class="heti-spacing"> </span>"<span class="heti-spacing"> </span></span>文件已生成<span><span class="heti-spacing"> </span>"</span>。</p>
</blockquote>
<h3 id="b"><span>B.<span class="heti-spacing"> </span></span>生成的分析文件<a class="headerlink" href="#b" title="Permanent link"><span><span class="heti-spacing"> </span>¶</span></a></h3>
<table>
<thead>
<tr>
<th>文件</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>decompiled.sol</code></td>
<td>反编译还原的<span class="heti-skip"><span class="heti-spacing"> </span>Solidity<span class="heti-spacing"> </span></span>伪代码</td>
</tr>
<tr>
<td><code>abi.json</code></td>
<td>自动还原的<span class="heti-skip"><span class="heti-spacing"> </span>ABI<span class="heti-spacing"> </span></span>接口定义</td>
</tr>
<tr>
<td><code>cfg.dot</code></td>
<td>控制流图（<span>Graphviz DOT<span class="heti-spacing"> </span></span>格式）</td>
</tr>
<tr>
<td><code>disassembled.asm</code></td>
<td>完整的反汇编操作码序列</td>
</tr>
<tr>
<td><code>reverse-engineering-report.md</code></td>
<td><span>AI Agent<span class="heti-spacing"> </span></span>生成的完整逆向分析报告</td>
</tr>
</tbody>
</table>
<p>所有文件的完整内容可在此查看：<a href="https://github.com/lifefindsitsway/web3-tutorials/tree/main/docs/assets/codes/0x411885324afd60404252213106c006e6fff84c79/"><span>Github<span class="heti-spacing"> </span></span>仓库目录</a></p>
<h3 id="c"><span>C.<span class="heti-spacing"> </span></span>参考资料<a class="headerlink" href="#c" title="Permanent link"><span><span class="heti-spacing"> </span>¶</span></a></h3>
<ul>
<li><a href="https://github.com/Jon-Becker/heimdall-rs/"><span>Heimdall-rs GitHub<span class="heti-spacing"> </span></span>仓库</a> — 源码、文档与<span class="heti-skip"><span class="heti-spacing"> </span>Issue<span class="heti-spacing"> </span></span>跟踪</li>
<li><a href="https://book.getfoundry.sh/">Foundry Book</a> — <span>Foundry<span class="heti-spacing"> </span></span>工具链官方文档（含 <code>cast storage</code> 等命令的详细用法）</li>
<li><a href="https://github.com/PraneshASP/foundry-mcp-server">Foundry MCP Server</a> — 本文使用的<span class="heti-skip"><span class="heti-spacing"> </span>MCP<span class="heti-spacing"> </span></span>集成方案，将<span class="heti-skip"><span class="heti-spacing"> </span>Foundry + Heimdall<span class="heti-spacing"> </span></span>工具暴露给<span><span class="heti-spacing"> </span>AI Agent</span></li>
<li><a href="https://openchain.xyz/signatures"><span>samczsun<span class="heti-spacing"> </span></span>函数签名数据库</a> — <span>Heimdall decode<span class="heti-spacing"> </span></span>模块使用的函数签名匹配源</li>
</ul>
<aside class="md-source-file">
<span class="md-source-file__fact">
<span class="md-icon" title="最后更新">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"></path></svg>
</span>
<span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-datetime">2026年2月17日 16:50:58</span>
</span>
</aside>
<!-- Insert generated snippet here -->
<script async="" crossorigin="anonymous" data-category="Comments" data-category-id="DIC_kwDOMt1b5c4CiWjc" data-emit-metadata="1" data-input-position="top" data-lang="zh-CN" data-loading="lazy" data-mapping="title" data-reactions-enabled="1" data-repo="lifefindsitsway/web3-tutorials" data-repo-id="R_kgDOMt1b5Q" data-strict="0" data-theme="light_protanopia" src="https://giscus.app/client.js">
</script>
<!-- Synchronize Giscus theme with palette -->
<script>
var giscus = document.querySelector("script[src*=giscus]")

// Set palette on initial load
var palette = __md_get("__palette")
if (palette && typeof palette.color === "object") {
    var theme = palette.color.scheme === "slate"
    ? "dark_protanopia"
    : "light_protanopia"

    // Instruct Giscus to set theme
    giscus.setAttribute("data-theme", theme) 
}

// Register event handlers after documented loaded
document.addEventListener("DOMContentLoaded", function() {
    var ref = document.querySelector("[data-md-component=palette]")
    ref.addEventListener("change", function() {
    var palette = __md_get("__palette")
    if (palette && typeof palette.color === "object") {
        var theme = palette.color.scheme === "slate"
        ? "dark_protanopia"
        : "light_protanopia"

        // Instruct Giscus to change theme
        var frame = document.querySelector(".giscus-frame")
        frame.contentWindow.postMessage(
        { giscus: { setConfig: { theme } } },
        "https://giscus.app"
        )
    }
    })
})
</script>
</article>
</div>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
<button class="md-top md-icon" data-md-component="top" hidden="" type="button">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg>
  回到页面顶部
</button>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
<div class="md-copyright__highlight">
      Copyright © 2024 ~ present by <a href="https://github.com/lifefindsitsway" rel="noopener noreferrer" target="_blank">Lifefindsitsway</a>
</div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
<div class="md-social">
<a class="md-social__link" href="https://github.com/lifefindsitsway/web3-tutorials/" rel="noopener" target="_blank" title="github.com">
<svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg>
</a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../../..", "features": ["header.autohide", "navigation.tracking", "navigation.top", "search.highlight", "search.share", "search.suggest", "content.code.copy", "content.code.annotate"], "search": "../../../assets/javascripts/workers/search.07f07601.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script>
<script src="../../../assets/javascripts/bundle.56dfad97.min.js"></script>
<script src="../../../assets/javascripts/mathjax-config.js"></script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</body>
</html>